<!DOCTYPE html>
<html><head><meta charset='UTF-8'><link href='https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap' rel='stylesheet'><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Lato',sans-serif;font-size:11pt;line-height:1.6;color:#1f2937;padding:20mm;max-width:210mm;margin:auto}h1{font-size:28pt;font-weight:900;color:#2563eb;margin-top:25pt;margin-bottom:15pt;padding-bottom:10pt;border-bottom:3px solid #2563eb}h2{font-size:20pt;font-weight:700;color:#1e40af;margin-top:20pt;margin-bottom:12pt}h3{font-size:16pt;font-weight:700;margin-top:15pt;margin-bottom:10pt}p{margin-bottom:10pt}code{background:#f3f4f6;padding:2pt  5pt;border-radius:3pt;font-size:9pt;color:#dc2626}pre{background:#f3f4f6;border-left:4px solid #2563eb;padding:12pt;margin:12pt 0;border-radius:5pt}table{width:100%;border-collapse:collapse;margin:15pt 0;font-size:10pt}thead{background:#2563eb;color:white}th,td{padding:8pt;border:1px solid #e5e7eb;text-align:left}tbody tr:nth-child(even){background:#f9fafb}ul,ol{margin:10pt 0;padding-left:25pt}li{margin-bottom:5pt}a{color:#2563eb;text-decoration:none;font-weight:600}hr{border:none;border-top:2px solid #e5e7eb;margin:20pt 0}.cover{page-break-after:always;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;background:linear-gradient(135deg,#2563eb,#1e40af);color:white;margin:-20mm;padding:20mm}.cover h1{color:white;border:none;font-size:48pt;margin-bottom:10mm;text-transform:uppercase;letter-spacing:2px}.cover h2{color:white;font-size:24pt;font-weight:300;margin-bottom:15mm}.cover p{font-size:14pt;margin-top:5mm}</style></head><body><div class='cover'><h1>Documenta√ß√£o T√©cnica</h1><h2>Portfolio de Fotografia</h2><p>Tiago Damasceno | 30/11/2025 | v1.0</p></div># Documenta√ß√£o T√©cnica Completa<br>## Portfolio de Fotografia - Tiago Damasceno<br><br>---<br><br>## üìã √çndice<br><br>1. [Vis√£o Geral do Projeto](#1-vis√£o-geral-do-projeto)<br>2. [Arquitetura do Sistema](#2-arquitetura-do-sistema)<br>3. [Stack Tecnol√≥gica](#3-stack-tecnol√≥gica)<br>4. [Estrutura do C√≥digo](#4-estrutura-do-c√≥digo)<br>5. [Componentes Principais](#5-componentes-principais)<br>6. [Hooks Customizados](#6-hooks-custom izados)<br>7. [Backend e Banco de Dados](#7-backend-e-banco-de-dados)<br>8. [Funcionalidades Implementadas](#8-funcionalidades-implementadas)<br>9. [Configura√ß√£o e Deploy](#9-configura√ß√£o-e-deploy)<br>10. [Hist√≥rico de Desenvolvimento](#10-hist√≥rico-de-desenvolvimento)<br><br>---<br><br>## 1. Vis√£o Geral do Projeto<br><br>### 1.1 Descri√ß√£o<br>Portfolio profissional de fotografia e design gr√°fico desenvolvido para **Tiago Damasceno**. A aplica√ß√£o √© uma plataforma web moderna que exibe trabalhos de fotografia em diferentes categorias (retratos, urbano, natureza, arte, eventos) e projetos de design gr√°fico (branding, editorial, web, ilustra√ß√£o, packaging).<br><br>### 1.2 Objetivos<br>- Apresentar portf√≥lio fotogr√°fico de forma elegante e profissional<br>- Permitir gerenciamento de conte√∫do via painel administrativo<br>- Oferecer experi√™ncia interativa com sistema de curtidas, compartilhamentos e coment√°rios<br>- Suportar internacionaliza√ß√£o (PT-BR e EN)<br>- Proteger imagens  contra download n√£o autorizado<br>- Otimizado para SEO e performance<br><br>### 1.3 P√∫blico-Alvo<br>- Clientes potenciais buscando servi√ßos de fotografia<br>- Recrutadores e empresas<br>- Visitantes interessados em trabalhos fotogr√°ficos e design<br><br>---<br><br>## 2. Arquitetura do Sistema<br><br>### 2.1 Arquitetura Geral<br><br>```mermaid<br>graph TB<br>    subgraph "Frontend - React + Vite"<br>        A[App.tsx] --> B[Router]<br>        B --> C[Pages]<br>        C --> D[Index/Home]<br>        C --> E[Photography]<br>        C --> F[Graphic Design]<br>        C --> G[About]<br>        C --> H[Admin Panel]<br>        C --> I[Contact]<br>        C --> J[Services]<br>        C --> K[Ranking]<br>    end<br>    <br>    subgraph "State Management"<br>        L[React Context]<br>        M[Custom Hooks]<br>        L --> N[LanguageContext]<br>        M --> O[useSupabaseData]<br>        M --> P[useImageProtection]<br>        M --> Q[useSearch]<br>    end<br>    <br>    subgraph "Backend - Supabase"<br>        R[Authentication]<br>        S[PostgreSQL Database]<br>        T[Storage Buckets]<br>        S --> U[(photography_table)]<br>        S --> V[(design_projects_table)]<br>        S --> W[(comments_table)]<br>        S --> X[(hero_images_table)]<br>        T --> Y[photography_bucket]<br>        T --> Z[design_bucket]<br>        T --> AA[hero_bucket]<br>    end<br>    <br>    C --> L<br>    C --> M<br>    M --> R<br>    M --> S<br>    M --> T<br>```<br><br>### 2.2 Fluxo de Dados<br><br>1. **Usu√°rio** acessa p√°gina ‚Üí **React Router** determina rota<br>2. **P√°gina/Componente** solicita dados via **Custom Hook**<br>3. **Hook** faz requisi√ß√£o ao **Supabase**<br>4. **Supabase ** retorna dados (ap√≥s validar RLS policies)<br>5. **Componente** renderiza dados no UI<br>6. **Intera√ß√µes do usu√°rio** (likes, comments) ‚Üí Update no Supabase<br>7. **Real-time updates** (opcional) via Supabase Realtime<br><br>---<br><br>## 3. Stack Tecnol√≥gica<br><br>### 3.1 Frontend<br><br>| Tecnologia | Vers√£o | Prop√≥sito |<br>|------------|--------|-----------|<br>| **React** | 18.3.1 | Framework principal UI |<br>| **TypeScript** | 5.8.3 | Tipagem est√°tica |<br>| **Vite** | 5.4.19 | Build tool e dev server |<br>| **React Router DOM** | 6.30.1 | Roteamento SPA |<br>| **Tailwind CSS** | 3.4.17 | Estiliza√ß√£o utility-first |<br>| **shadcn/ui** | - | Componentes UI (Radix UI) |<br>| **Lucide React** | 0.462.0 | √çcones SVG |<br><br>### 3.2 Backend/Database<br><br>| Tecnologia | Prop√≥sito |<br>|------------|-----------|<br>| **Supabase** | Backend-as-a-Service |<br>| **PostgreSQL** | Banco de dados relacional |<br>| **Supabase Storage** | Armazenamento de imagens |<br>| **Supabase Auth** | Autentica√ß√£o de administradores |<br>| **Row Level Security (RLS)** | Controle de acesso granular |<br><br>### 3.3 Bibliotecas Adicionais<br><br>| Biblioteca | Prop√≥sito |<br>|------------|-----------|<br>| **exifr** | Extra√ß√£o de metadados EXIF de fotos |<br>| **react-helmet-async** | Gerenciamento de meta tags SEO |<br>| **embla-carousel-react** | Carross√©is de imagens |<br>| **react-hook-form** | Gerenciamento de formul√°rios |<br>| **zod** | Valida√ß√£o de schemas |<br>| **date-fns** | Manipula√ß√£o de datas |<br>| **@tanstack/react-query** | Cache e sincroniza√ß√£o de dados |<br><br>---<br><br>## 4. Estrutura do C√≥digo<br><br>### 4.1 Estrutura de Diret√≥rios<br><br>```<br>Portifolio/<br>‚îú‚îÄ‚îÄ src/<br>‚îÇ   ‚îú‚îÄ‚îÄ pages/              # P√°ginas principais da aplica√ß√£o<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Index.tsx       # P√°gina inicial<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Photography.tsx # Galeria de fotografias<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GraphicDesign.tsx # Portf√≥lio de design<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AboutPage.tsx   # Sobre o fot√≥grafo  <br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Admin.tsx       # Painel administrativo  <br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Contact.tsx     # P√°gina de contato<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Services.tsx    # Servi√ßos oferecidos<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Ranking.tsx     # Ranking de trabalhos<br>‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ NotFound.tsx    # P√°gina 404<br>‚îÇ   ‚îÇ<br>‚îÇ   ‚îú‚îÄ‚îÄ components/         # Componentes reutiliz√°veis<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/             # Componentes shadcn/ui (49 componentes)<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Hero.tsx        # Banner hero<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Navigation.tsx  # Barra de navega√ß√£o<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Footer.tsx      # Rodap√©<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PhotoGrid.tsx   # Grade de fotos<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DesignGrid.tsx  # Grade de projetos<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Lightbox.tsx    # Visualiza√ß√£o de imagem expandida<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CommentsSection.tsx # Sistema de coment√°rios<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InteractionBar.tsx  # Likes/shares/comments<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RankingSection.tsx  # Se√ß√£o de ranking<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProtectedImage.tsx  # Prote√ß√£o de imagens<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SearchBar.tsx   # Busca<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LanguageSelector.tsx # Seletor de idioma<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BatchUpload.tsx  # Upload m√∫ltiplo<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AllCommentsManagement.tsx # Gerenciamento de coment√°rios<br>‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...<br>‚îÇ   ‚îÇ<br>‚îÇ   ‚îú‚îÄ‚îÄ hooks/              # Custom React Hooks<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useSupabaseData.ts    # Integra√ß√£o com Supabase<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useImageProtection.ts # Prote√ß√£o de imagens<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useSearch.ts          # Funcionalidade de busca<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ use-toast.ts          # Sistema de notifica√ß√µes<br>‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ use-mobile.tsx        # Detec√ß√£o de mobile<br>‚îÇ   ‚îÇ<br>‚îÇ   ‚îú‚îÄ‚îÄ contexts/           # React Contexts<br>‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LanguageContext.tsx   # Contexto de internacionaliza√ß√£o<br>‚îÇ   ‚îÇ<br>‚îÇ   ‚îú‚îÄ‚îÄ lib/                # Utilit√°rios e configura√ß√µes<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts     # Cliente e tipos Supabase<br>‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils.ts        # Fun√ß√µes utilit√°rias<br>‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exifExtractor.ts # Extra√ß√£o de EXIF<br>‚îÇ   ‚îÇ<br>‚îÇ   ‚îú‚îÄ‚îÄ App.tsx             # Componente raiz<br>‚îÇ   ‚îú‚îÄ‚îÄ main.tsx            # Entry point<br>‚îÇ   ‚îî‚îÄ‚îÄ index.css           # Estilos globais<br>‚îÇ<br>‚îú‚îÄ‚îÄ public/                 # Arquivos est√°ticos<br>‚îú‚îÄ‚îÄ *.sql                   # Scripts de migra√ß√£o/configura√ß√£o DB<br>‚îú‚îÄ‚îÄ package.json            # Depend√™ncias e scripts<br>‚îú‚îÄ‚îÄ vite.config.ts          # Configura√ß√£o Vite<br>‚îú‚îÄ‚îÄ tailwind.config.ts      # Configura√ß√£o Tailwind<br>‚îú‚îÄ‚îÄ tsconfig.json           # Configura√ß√£o TypeScript<br>‚îî‚îÄ‚îÄ README.md               # Documenta√ß√£o b√°sica<br>```<br><br>### 4.2 Contagem de Arquivos<br><br>- **P√°ginas**: 9 arquivos<br>- **Componentes**: 21 componentes customizados + 49 componentes UI = **70 componentes**<br>- **Hooks**: 5 custom hooks<br>- **Contextos**: 1 contexto principal<br>- **Scripts SQL**: ~30 arquivos de migra√ß√£o e configura√ß√£o<br><br>---<br><br>## 5. Componentes Principais<br><br>### 5.1 P√°ginas<br><br>#### `Index.tsx` - P√°gina Inicial<br>- **Prop√≥sito**: Landing page com hero banner e preview de trabalhos<br>- **Funcionalidades**:<br>  - Hero carousel com imagens em destaque<br>  - Se√ß√£o "Sobre"<br>  - Preview de fotografias e projetos de design<br>  - CTA para servi√ßos<br><br>#### `Photography.tsx` - Galeria de Fotografias<br>- **Prop√≥sito**: Exibir portf√≥lio fotogr√°fico completo  <br>- **Funcionalidades**:<br>  - Filtros por categoria (retratos, urbano, natureza, arte, eventos)<br>  - Busca por t√≠tulo, descri√ß√£o, tags<br>  - Lightbox para visualiza√ß√£o ampliada<br>  - Sistema de likes, compartilhamentos e coment√°rios<br>  - Exibi√ß√£o de metadados EXIF<br>  - Prote√ß√£o contra download<br><br>#### `GraphicDesign.tsx` - Portf√≥lio de Design<br>- **Prop√≥sito**: Showcase de projetos de design gr√°fico<br>- **Funcionalidades**:<br>  - Filtros por categoria<br>  - Modal de projeto com m√∫ltiplas imagens<br>  - Informa√ß√µes do cliente e ano<br>  - Sistema de intera√ß√£o social<br><br>#### `Admin.tsx` - Painel Administrativo<br>- **Prop√≥sito**: Gerenciamento de conte√∫do (CRUD)<br>- **Funcionalidades**:<br>  - Autentica√ß√£o via Supabase Auth<br>  - Upload de fotografias com extra√ß√£o autom√°tica de EXIF  <br>  - Upload de projetos de design (m√∫ltiplas imagens)<br>  - Gerenciamento de imagens hero<br>  - Modera√ß√£o de coment√°rios<br>  - Gerenciamento de conte√∫do do site<br>  - Batch upload (upload em lote)<br>  - Interface traduzida para PT-BR<br><br>### 5.2 Componentes de UI<br><br>#### `Navigation.tsx` - Navega√ß√£o Principal<br>```typescript<br>// Navega√ß√£o responsiva com menu mobile<br>- Links: Home, Photography, Design, About, Services, Contact<br>- Seletor de idioma<br>- Modo escuro/claro (via next-themes)<br>- Menu hamburger em mobile<br>```<br><br>#### `Hero.tsx` - Banner Hero<br>```typescript<br>// Carousel de imagens hero vindas do Supabase<br>- Auto-play<br>- Fade transition<br>- Controles de navega√ß√£o<br>- Imagens gerenciadas via Admin<br>```<br><br>#### `PhotoGrid.tsx` - Grade de Fotos<br>```typescript<br>// Grid responsivo de fotografias<br>- Layout Masonry/Grid<br>- Lazy loading de imagens<br>- Click para lightbox<br>- Exibi√ß√£o de categoria e t√≠tulo<br>- Intera√ß√£o: likes, comments, shares<br>```<br><br>#### `CommentsSection.tsx` - Sistema de Coment√°rios<br>```typescript<br>// √Årea de coment√°rios com modera√ß√£o<br>- Form para novo coment√°rio<br>- Lista de coment√°rios aprovados<br>- Suporte a respostas (threads)<br>- Indicador de coment√°rio do admin<br>- Aprova√ß√£o necess√°ria antes de exibi√ß√£o p√∫blica<br>```<br><br>#### `ProtectedImage.tsx` - Prote√ß√£o de Imagens<br>```typescript<br>// Componente que protege imagens contra download<br>- Desabilita click direito<br>- Previne arrastar imagem<br>- Watermark opcional<br>- Mensagem de prote√ß√£o<br>```<br><br>#### `Lightbox.tsx` - Visualizador de Imagens<br>```typescript<br>// Modal para visualiza√ß√£o ampliada<br>- Navega√ß√£o entre imagens<br>- Zoom<br>- Exibi√ß√£o de metadados (EXIF, t√≠tulo, descri√ß√£o)<br>- Fechar com ESC ou click fora<br>```<br><br>#### `InteractionBar.tsx` - Barra de Intera√ß√£o<br>```typescript<br>// Bot√µes de like, share, comment<br>- Contadores em tempo real<br>- Anima√ß√µes ao clicar<br>- Persist√™ncia no banco de dados<br>```<br><br>### 5.3 Componentes Admin<br><br>#### `BatchUpload.tsx` - Upload em Lote<br>- Upload m√∫ltiplo de arquivos<br>- Extra√ß√£o autom√°tica de EXIF  <br>- Preview de imagens<br>- Progress bar<br>- Valida√ß√£o de tipos de arquivo<br><br>#### `AllCommentsManagement.tsx` - Gerenciamento de Coment√°rios<br>- Lista todos os coment√°rios (aprovados e pendentes)<br>- Filtros por status<br>- Deletar coment√°rios<br>- Responder como admin<br>- Exibi√ß√£o de threads (respostas aninhadas)<br><br>---<br><br>## 6. Hooks Customizados<br><br>### 6.1 `useSupabaseData.ts`<br><br>Hook principal para integra√ß√£o com Supabase. Fornece fun√ß√µes para buscar e manipular dados.<br><br>```typescript<br>// Principais exports:<br><br>// 1. usePhotography - Buscar fotografias<br>const { photos, loading, refresh } = usePhotography(category?: string)<br><br>// 2. useDesignProjects - Buscar projetos de design<br>const { projects, loading, refresh } = useDesignProjects(category?: string)<br><br>// 3. useComments - Gerenciar coment√°rios de um item<br>const { comments, loading, addComment, refresh } = useComments(<br>  itemId: string, <br>  type: 'photography' | 'design'<br>)<br><br>// 4. useAuth - Autentica√ß√£o<br>const { user, loading, signIn, signOut } = useAuth()<br><br>// 5. useAdminComments - Modera√ß√£o de coment√°rios (admin)<br>const { pendingComments, loading, approveComment, rejectComment, refresh } = useAdminComments()<br><br>// 6. useAllComments - Todos os coment√°rios (admin)<br>const { allComments, loading, refresh } = useAllComments()<br><br>// 7. useTopRated - Rankings<br>const { topPhotos, topProjects, loading } = useTopRated(limit?)<br><br>// Fun√ß√µes auxiliares:<br>incrementLikes(id: string, type: 'photography' | 'design')<br>incrementShares(id: string, type: 'photography' | 'design')<br>deleteComment(id: string)<br>addReply(parentId: string, content: string, itemId: string, type)<br>```<br><br>**Implementa√ß√£o**:<br>- 368 linhas de c√≥digo<br>- 25 fun√ß√µes/hooks exportados<br>- Integra√ß√£o com Row Level Security (RLS)<br>- Tratamento de erros<br>- Shuffle algorithm para randomiza√ß√£o<br><br>### 6.2 `useImageProtection.ts`<br><br>Protege imagens contra download n√£o autorizado.<br><br>```typescript<br>const useImageProtection = () => {<br>  // Previne click direito em imagens<br>  // Previne arrastar imagens<br>  // Adiciona event listeners em mount<br>  // Remove em unmount<br>}<br>```<br><br>### 6.3 `useSearch.ts`<br><br>Implementa funcionalidade de busca.<br><br>```typescript<br>const useSearch = (items: T[], searchKeys: (keyof T)[]) => {<br>  const [searchTerm, setSearchTerm] = useState('')<br>  const filteredItems = // ... l√≥gica de filtro<br>  <br>  return { searchTerm, setSearchTerm, filteredItems }<br>}<br>```<br><br>### 6.4 `use-toast.ts`<br><br>Sistema de notifica√ß√µes toast (shadcn/ui).<br><br>### 6.5 `use-mobile.tsx`<br><br>Detecta se est√° em dispositivo m√≥vel via media query.<br><br>---<br><br>## 7. Backend e Banco de Dados<br><br>### 7.1 Configura√ß√£o Supabase<br><br>**URL do Projeto**: Configurado via vari√°vel de ambiente `VITE_SUPABASE_URL`  <br>**Anon Key**: Configurado via `VITE_SUPABASE_ANON_KEY`<br><br>### 7.2 Schema do Banco de Dados<br><br>#### Tabela: `photography`<br><br>```sql<br>CREATE TABLE photography (<br>  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),<br>  title TEXT NOT NULL,<br>  category TEXT CHECK (category IN ('portraits', 'urban', 'nature', 'art', 'events')),<br>  url TEXT NOT NULL,<br>  description TEXT,<br>  year INTEGER,<br>  event_name TEXT,<br>  event_date DATE,<br>  tags TEXT[],<br>  <br>  -- Metadados EXIF<br>  camera_make TEXT,<br>  camera_model TEXT,<br>  lens_model TEXT,<br>  iso INTEGER,<br>  aperture TEXT,<br>  shutter_speed TEXT,<br>  focal_length TEXT,<br>  capture_date TIMESTAMP,<br>  <br>  -- Contadores sociais<br>  likes_count INTEGER DEFAULT 0,<br>  comments_count INTEGER DEFAULT 0,<br>  shares_count INTEGER DEFAULT 0,<br>  <br>  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),<br>  updated_at TIMESTAMPTZ DEFAULT NOW()<br>);<br>```<br><br>#### Tabela: `design_projects`<br><br>```sql<br>CREATE TABLE design_projects (<br>  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),<br>  title TEXT NOT NULL,<br>  category TEXT CHECK (category IN ('branding', 'editorial', 'web', 'illustration', 'packaging')),<br>  description TEXT NOT NULL,<br>  images TEXT[] NOT NULL,  -- Array de URLs<br>  client TEXT,<br>  year INTEGER,<br>  link TEXT,<br>  event_name TEXT,<br>  event_date DATE,<br>  tags TEXT[],<br>  <br>  -- Contadores sociais<br>  likes_count INTEGER DEFAULT 0,<br>  comments_count INTEGER DEFAULT 0,<br>  shares_count INTEGER DEFAULT 0,<br>  <br>  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),<br>  updated_at TIMESTAMPTZ DEFAULT NOW()<br>);<br>```<br><br>#### Tabela: `comments`<br><br>```sql<br>CREATE TABLE comments (<br>  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),<br>  content TEXT NOT NULL,<br>  user_name TEXT NOT NULL DEFAULT 'Anonymous',<br>  photo_id UUID REFERENCES photography(id) ON DELETE CASCADE,<br>  project_id UUID REFERENCES design_projects(id) ON DELETE CASCADE,<br>  parent_id UUID REFERENCES comments(id) ON DELETE CASCADE,  -- Para respostas<br>  approved BOOLEAN DEFAULT FALSE,<br>  is_admin BOOLEAN DEFAULT FALSE,<br>  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()<br>);<br>```<br><br>#### Tabela: `hero_images`<br><br>```sql<br>CREATE TABLE hero_images (<br>  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),<br>  url TEXT NOT NULL,<br>  title TEXT NOT NULL,<br>  active BOOLEAN DEFAULT TRUE,<br>  page TEXT,  -- 'home', 'photography', 'design', etc.<br>  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()<br>);<br>```<br><br>### 7.3 Row Level Security (RLS) Policies<br><br>#### Leitura P√∫blica<br>Todas as tabelas permitem leitura p√∫blica para exibi√ß√£o no site:<br><br>```sql<br>CREATE POLICY "Permitir leitura p√∫blica"<br>ON [table_name] FOR SELECT<br>USING (true);<br>```<br><br>#### Escrita Apenas para Autenticados<br>Inser√ß√£o, atualiza√ß√£o e dele√ß√£o requerem autentica√ß√£o:<br><br>```sql<br>CREATE POLICY "Apenas autenticados podem inserir"<br>ON [table_name] FOR INSERT<br>WITH CHECK (auth.role() = 'authenticated');<br><br>CREATE POLICY "Apenas autenticados podem atualizar"<br>ON [table_name] FOR UPDATE<br>USING (auth.role() = 'authenticated');<br><br>CREATE POLICY "Apenas autenticados podem deletar"<br>ON [table_name] FOR DELETE<br>USING (auth.role() = 'authenticated');<br>```<br><br>#### Coment√°rios - Aprova√ß√£o<br>```sql<br>-- Apenas coment√°rios aprovados s√£o vis√≠veis publicamente<br>CREATE POLICY "Leitura apenas coment√°rios aprovados"<br>ON comments FOR SELECT<br>USING (approved = TRUE OR auth.role() = 'authenticated');<br>```<br><br>### 7.4 Storage (Buckets)<br><br>#### Bucket: `photography`<br>- **Visibilidade**: P√∫blico<br>- **Prop√≥sito**: Armazenar imagens de fotografia<br>- **Pol√≠ticas**:<br>  - Leitura p√∫blica: Permitida<br>  - Upload: Apenas autenticados<br>  - Dele√ß√£o: Apenas autenticados<br><br>#### Bucket: `design`<br>- **Visibilidade**: P√∫blico<br>- **Prop√≥sito**: Armazenar imagens de projetos de design<br>- **Pol√≠ticas**: Id√™nticas ao bucket `photography`<br><br>#### Bucket: `hero`<br>- ** Visibilidade**: P√∫blico<br>- **Prop√≥sito**: Armazenar imagens para banners hero<br>- **Pol√≠ticas**: Id√™nticas aos demais<br><br>### 7.5 Triggers e Functions<br><br>#### Trigger: Atualizar Contador de Coment√°rios<br>```sql<br>CREATE OR REPLACE FUNCTION update_comment_count()<br>RETURNS TRIGGER AS $$<br>BEGIN<br>  -- Ao aprovar/adicionar coment√°rio, incrementa contador na tabela pai<br>  -- Implementa√ß√£o autom√°tica via trigger<br>END;<br>$$ LANGUAGE plpgsql;<br>```<br><br>---<br><br>## 8. Funcionalidades Implementadas<br><br>### 8.1 Sistema de Autentica√ß√£o<br>- Login de administrador via email/senha<br>- Sess√£o persistente<br>- Prote√ß√£o de rotas administrativas<br>- Logout<br><br>### 8.2 Gerenciamento de Fotografias<br>- ‚úÖ Upload de fotos individuais<br>- ‚úÖ Batch upload (m√∫ltiplas fotos)<br>- ‚úÖ Extra√ß√£o autom√°tica de metadados EXIF<br>- ‚úÖ Categoriza√ß√£o (portraits, urban, nature, art, events)<br>- ‚úÖ Adi√ß√£o manual de tags, eventos, descri√ß√µes<br>- ‚úÖ Edi√ß√£o de metadados<br>- ‚úÖ Dele√ß√£o de fotos<br>- ‚úÖ Exibi√ß√£o em galeria com filtros<br><br>### 8.3 Gerenciamento de Projetos de Design<br>- ‚úÖ Upload de projetos com m√∫ltiplas imagens<br>- ‚úÖ Categoriza√ß√£o (branding, editorial, web, illustration, packaging)<br>- ‚úÖ Informa√ß√µes de cliente e ano<br>- ‚úÖ Links externos<br>- ‚úÖ Edi√ß√£o e dele√ß√£o<br><br>### 8.4 Sistema de Coment√°rios<br>- ‚úÖ Coment√°rios an√¥nimos ou com nome<br>- ‚úÖ Modera√ß√£o (aprova√ß√£o manual)<br>- ‚úÖ Respostas do admin<br>- ‚úÖ Threads (respostas aninhadas)<br>- ‚úÖ Dele√ß√£o de coment√°rios<br>- ‚úÖ Filtros por status (aprovados/pendentes)<br>- ‚úÖ Contador de coment√°rios atualizado automaticamente<br><br>### 8.5 Sistema  de Intera√ß√£o Social<br>- ‚úÖ Curtidas (likes) em fotos e projetos<br>- ‚úÖ Compartilhamentos  <br>- ‚úÖ Contadores em tempo real<br>- ‚úÖ Persist√™ncia no banco de dados<br><br>### 8.6 Ranking de Trabalhos<br>- ‚úÖ Top trabalhos por likes<br>- ‚úÖ Top trabalhos por coment√°rios<br>- ‚úÖ Top trabalhos por engajamento total<br>- ‚úÖ Exibi√ß√£o diferenciada<br><br>### 8.7 Prote√ß√£o de Imagens<br>- ‚úÖ Desabilitar click direito<br>- ‚úÖ Prevenir arrastar imagem<br>- ‚úÖ Mensagens de prote√ß√£o<br><br>### 8.8 Busca e Filtros<br>- ‚úÖ Busca por t√≠tulo, descri√ß√£o, tags<br>- ‚úÖ Filtros por categoria<br>- ‚úÖ Busca em tempo real<br><br>### 8.9 Internacionaliza√ß√£o<br>- ‚úÖ Suporte a PT-BR e EN<br>- ‚úÖ Contexto de idioma<br>- ‚úÖ Seletor de idioma no header<br><br>### 8.10 SEO<br>- ‚úÖ Meta tags din√¢micas por p√°gina<br>- ‚úÖ Open Graph para redes sociais<br>- ‚úÖ Sitemap<br>- ‚úÖ Tags can√¥nicas<br><br>### 8.11 Responsividade<br>- ‚úÖ Design mobile-first<br>- ‚úÖ Breakpoints Tailwind<br>- ‚úÖ Menu hamburger em mobile<br>- ‚úÖ Grids adaptativas<br><br>---<br><br>## 9. Configura√ß√£o e Deploy<br><br>### 9.1 Requisitos<br><br>- Node.js 18+ e npm<br>- Conta na Supabase<br>- Git<br><br>### 9.2 Instala√ß√£o Local<br><br>```bash<br># Clone o reposit√≥rio<br>git clone <repository_url><br>cd Portifolio<br><br># Instale depend√™ncias<br>npm install<br><br># Configure vari√°veis de ambiente<br>cp .env.example .env<br># Edite .env com suas credenciais Supabase<br><br># Inicie servidor de desenvolvimento<br>npm run dev<br><br># Build para produ√ß√£o<br>npm run build<br><br># Preview da build de produ√ß√£o<br>npm run preview<br>```<br><br>### 9.3 Vari√°veis de Ambiente<br><br>Arquivo `.env`:<br>```env<br>VITE_SUPABASE_URL=https://seu-projeto.supabase.co<br>VITE_SUPABASE_ANON_KEY=sua_anon_key_aqui<br>```<br><br>### 9.4 Scripts Dispon√≠veis<br><br>```json<br>{<br>  "dev": "vite",                    // Dev server<br>  "build": "vite build",             // Build produ√ß√£o<br>  "build:dev": "vite build --mode development",<br>  "lint": "eslint .",                // Lint c√≥digo<br>  "preview": "vite preview"          // Preview build<br>}<br>```<br><br>### 9.5 Deploy<br><br>#### Vercel (Recomendado)<br>1. Conecte reposit√≥rio no Vercel<br>2. Configure vari√°veis de ambiente<br>3. Deploy autom√°tico<br><br>#### Netlify<br>1. Conecte reposit√≥rio no Netlify<br>2. Build command: `npm run build`<br>3. Publish directory: `dist`<br>4. Configure vari√°veis de ambiente<br><br>### 9.6 Configura√ß√£o do Supabase<br><br>Ver arquivo `SUPABASE_SETUP.md` para guia detalhado passo-a-passo.<br><br>**Resumo**:<br>1. Criar projeto no Supabase<br>2. Executar scripts SQL para criar tabelas<br>3. Configurar buckets de storage<br>4. Aplicar RLS policies<br>5. Criar usu√°rio admin<br>6. Copiar credenciais para `.env`<br><br>---<br><br>## 10. Hist√≥rico de Desenvolvimento<br><br>### Fase 1: Estrutura Inicial<br>- Setup do projeto com Vite + React + TypeScript<br>- Configura√ß√£o Tailwind CSS<br>- Instala√ß√£o shadcn/ui<br>- Estrutura de rotas (React Router)<br>- P√°ginas b√°sicas (Home, Photography, Design, About)<br><br>### Fase 2: Integra√ß√£o Supabase<br>- Cria√ß√£o de conta e projeto no Supabase<br>- Configura√ß√£o de tabelas (`photography`, `design_projects`)<br>- Implementa√ß√£o de hooks (`useSupabaseData.ts`)<br>- Sistema de upload de imagens<br>- Configura√ß√£o de storage buckets<br><br>### Fase 3: Painel Administrativo<br>- P√°gina Admin com autentica√ß√£o<br>- CRUD de fotografias<br>- CRUD de projetos de design<br>- Sistema de batch upload<br>- Gerenciamento de imagens hero<br>- Extra√ß√£o autom√°tica de EXIF<br><br>### Fase 4: Sistema de Coment√°rios<br>- Tabela de coment√°rios no Supabase<br>- Componente CommentsSection<br>- Sistema de modera√ß√£o (aprova√ß√£o)<br>- Respostas do admin<br>- Threads (respostas aninhadas)<br>- Painel de gerenciamento de coment√°rios<br><br>### Fase 5: Intera√ß√µes Sociais<br>- Sistema de likes (curtidas)<br>- Sistema de shares (compartilhamentos)<br>- Contadores em tempo real<br>- Triggers para atualizar contadores<br>- Ranking de trabalhos mais curtidos<br><br>### Fase 6: Prote√ß√£o e SEO<br>- Prote√ß√£o de imagens contra download<br>- Meta tags din√¢micas  <br>- SEO por p√°gina<br>- Open Graph tags<br><br>### Fase 7: Internacionaliza√ß√£o<br>- Contexto de idioma (PT-BR/EN)<br>- Tradu√ß√£o de componentes<br>- Seletor de idioma<br><br>### Fase 8: Tradu√ß√£o do Admin<br>- Tradu√ß√£o completa do painel para PT-BR<br>- Cabe√ßalho e navega√ß√£o<br>- Formul√°rios e labels<br>- Mensagens de feedback<br><br>### Fase 9: Refinamentos Finais<br>- Melhorias de UX<br>- Responsividade mobile<br>- Performance otimizations<br>- Bug fixes<br><br>---<br><br>## üìä Estat√≠sticas do Projeto<br><br>| M√©trica | Valor |<br>|---------|-------|<br>| **P√°ginas** | 9 |<br>| **Componentes Customizados** | 21 |<br>| **Componentes shadcn/ui** | 49 |<br>| **Hooks Customizados** | 5 |<br>| **Linhas de C√≥digo (estimado)** | ~15.000+ |<br>| **Depend√™ncias NPM** | 56 |<br>| **Depend√™ncias Dev** | 12 |<br>| **Tabelas no Banco** | 4 principais |<br>| **Buckets de Storage** | 3 |<br>| **Scripts SQL** | ~30 |<br><br>---<br><br>## üîí Seguran√ßa<br><br>### Implementa√ß√µes de Seguran√ßa<br><br>1. **Row Level Security (RLS)**: Todas as tabelas protegidas<br>2. **Autentica√ß√£o**: Apenas usu√°rios autenticados podem administrar<br>3. **Valida√ß√£o de Upload**: Tipos de arquivo permitidos<br>4. **Sanitiza√ß√£o**: Inputs sanitizados antes de inserir no DB<br>5. **Environment Variables**: Credenciais n√£o commitadas<br>6. **HTTPS**: Comunica√ß√£o criptografada com Supabase<br><br>---<br><br>## üöÄ Performance<br><br>### Otimiza√ß√µes Implementadas<br><br>1. **Lazy Loading**: Imagens carregadas sob demanda<br>2. **Code Splitting**: Rotas separadas em chunks<br>3. **Vite Build**: Build otimizado para produ√ß√£o<br>4. **Tailwind Purge**: CSS n√£o utilizado removido<br>5. **Image Compression**: Imagens comprimidas no upload<br>6. **Caching**: Estrat√©gias de cache no Supabase<br><br>---<br><br>## üì± Responsividade<br><br>### Breakpoints<br><br>- **Mobile**: < 640px<br>- **Tablet**: 640px - 1024px<br>- **Desktop**: > 1024px<br><br>### Recursos Mobile<br><br>- Menu hamburger<br>- Touch gestures<br>- Grids adaptativas<br>- Imagens otimizadas por resolu√ß√£o<br><br>---<br><br>## üé® Design System<br><br>### Cores (Tailwind)<br><br>Configuradas em `tailwind.config.ts`:<br>- Primary: Definido no tema<br>- Secondary: Definido no tema<br>- Accent: Neon/vibrante para CTAs<br>- Background/Foreground: Suporte dark mode<br><br>### Tipografia<br><br>- **Font Display**: Para t√≠tulos<br>- **Font Sans**: Para corpo do texto<br>- **Font Mono**: Para c√≥digo/metadados<br><br>### Componentes UI<br><br>Todos os componentes s√£o do shadcn/ui baseados em Radix UI:<br>- Accordion, Alert Dialog, Avatar, Button, Card, Checkbox, Dialog<br>- Dropdown Menu, Input, Label, Select, Tabs, Textarea, Toast<br>- E mais 40+ componentes<br><br>---<br><br>## üîÑ Estado Futuro / Roadmap<br><br>### Melhorias Planejadas<br><br>- [ ] PWA (Progressive Web App)<br>- [ ] Otimiza√ß√£o de imagens com Next/Image ou similar<br>- [ ] Sistema de favoritos para visitantes<br>- [ ] Blog integrado<br>- [ ] Admin: analytics de visualiza√ß√µes<br>- [ ] Galeria em fullscreen<br>- [ ] Compara√ß√£o antes/depois para edi√ß√µes<br>- [ ] Suporte a v√≠deos<br>- [ ] Newsletter integration<br><br>---<br><br>## üìö Recursos e Documenta√ß√£o<br><br>### Documenta√ß√£o Externa<br><br>- [React Documentation](https://react.dev/)<br>- [Vite Documentation](https://vitejs.dev/)<br>- [Supabase Docs](https://supabase.com/docs)<br>- [Tailwind CSS Docs](https://tailwindcss.com/docs)<br>- [shadcn/ui](https://ui.shadcn.com/)<br><br>### Documenta√ß√£o Interna<br><br>- `README.md`: Guia b√°sico<br>- `SUPABASE_SETUP.md`: Configura√ß√£o detalhada do backend<br>- `COMMENT_COUNT_SYSTEM.md`: Sistema de contadores de coment√°rios<br><br>---<br><br>## üë®‚Äçüíª Autor<br><br>**Tiago Damasceno**  <br>Fot√≥grafo e Designer Gr√°fico<br><br>---<br><br>## üìÑ Licen√ßa<br><br>Projeto propriet√°rio. Todos os direitos reservados.<br><br>---<br><br>**Documenta√ß√£o gerada em**: 30 de Novembro de 2025  <br>**Vers√£o**: 1.0.0  <br>**√öltima atualiza√ß√£o**: Tradu√ß√£o do painel administrativo para PT-BR<br><br>---<br><br>*Esta documenta√ß√£o foi gerada automaticamente a partir do c√≥digo-fonte e arquivos de configura√ß√£o do projeto.*<br># Guia T√©cnico Detalhado e Orienta√ß√µes<br>## Portfolio de Fotografia - Ferramentas e Implementa√ß√µes<br><br>---<br><br>## üìã √çndice<br><br>1. [Vis√£o Geral das Escolhas Tecnol√≥gicas](#1-vis√£o-geral-das-escolhas-tecnol√≥gicas)<br>2. [Frontend - Ferramentas e Justificativas](#2-frontend---ferramentas-e-justificativas)<br>3. [Backend - Supabase em Detalhes](#3-backend---supabase-em-detalhes)<br>4. [Bibliotecas Especializadas](#4-bibliotecas-especializadas)<br>5. [Implementa√ß√µes Customizadas](#5-implementa√ß√µes-customizadas)<br>6. [Padr√µes de C√≥digo e Best Practices](#6-padr√µes-de-c√≥digo-e-best-practices)<br>7. [Guias de Implementa√ß√£o Espec√≠ficos](#7-guias-de-implementa√ß√£o-espec√≠ficos)<br><br>---<br><br>## 1. Vis√£o Geral das Escolhas Tecnol√≥gicas<br><br>### 1.1 Filosofia de Desenvolvimento<br><br>**Princ√≠pios Seguidos**:<br>- **Developer Experience (DX)**: Ferramentas que aceleram desenvolvimento<br>- **Performance First**: Build otimizado e carregamento r√°pido<br>- **Type Safety**: TypeScript em todo projeto<br>- **Component Reusability**: Componentes pequenos e reutiliz√°veis<br>- **Backend as a Service**: Foco no frontend, backend gerenciado<br>- **Modern Best Practices**: React Hooks, functional components<br><br>---<br><br>## 2. Frontend - Ferramentas e Justificativas<br><br>### 2.1 React 18.3.1<br><br>**Por que React?**<br>- ‚úÖ **Ecossistema Maduro**: Maior biblioteca de componentes do mercado<br>- ‚úÖ **Performance**: Virtual DOM e reconcilia√ß√£o eficiente<br>- ‚úÖ **Hooks**: L√≥gica reutiliz√°vel sem classes<br>- ‚úÖ **Comunidade**: Suporte massivo, documenta√ß√£o extensa<br>- ‚úÖ **Hiring**: Facilidade de encontrar desenvolvedores<br><br>**Orienta√ß√µes de Uso no Projeto**:<br>```typescript<br>// SEMPRE use functional components com hooks<br>const MyComponent = () => {<br>  const [state, setState] = useState(initialValue)<br>  <br>  useEffect(() => {<br>    // Side effects aqui<br>  }, [dependencies])<br>  <br>  return <div>{/* JSX */}</div><br>}<br><br>// EVITE class components<br>```<br><br>**Implementa√ß√µes-Chave**:<br>- **Hooks Customizados**: Toda l√≥gica de neg√≥cio em hooks reutiliz√°veis<br>- **Context API**: Gerenciamento de estado global (idioma)<br>- **Lazy Loading**: Componentes carregados apenas quando necess√°rios<br><br>---<br><br>### 2.2 TypeScript 5.8.3<br><br>**Por que TypeScript?**<br>- ‚úÖ **Type Safety**: Erros detectados em tempo de compila√ß√£o<br>- ‚úÖ **IntelliSense**: Autocompleta√ß√£o inteligente na IDE<br>- ‚úÖ **Refactoring**: Mudan√ßas seguras em toda codebase<br>- ‚úÖ **Documentation**: Tipos servem como documenta√ß√£o viva<br>- ‚úÖ **Escalabilidade**: Projeto cresce sem perder controle<br><br>**Orienta√ß√µes de Uso**:<br>```typescript<br>// ‚úÖ BOM: Interfaces expl√≠citas<br>interface PhotographyItem {<br>  id: string<br>  title: string<br>  category: 'portraits' | 'urban' | 'nature' | 'art' | 'events'<br>  url: string<br>}<br><br>// ‚úÖ BOM: Tipagem de fun√ß√µes<br>async function uploadPhoto(file: File): Promise<string> {<br>  // implementa√ß√£o<br>}<br><br>// ‚ùå EVITE: any<br>const data: any = await fetch() // MAU!<br><br>// ‚úÖ MELHOR: Tipos espec√≠ficos<br>const data: PhotographyItem[] = await fetch()<br>```<br><br>**Implementa√ß√µes no Projeto**:<br>- **src/lib/supabase.ts**: Interfaces definindo estrutura do DB<br>- **Strict Mode**: `tsconfig.json` com configura√ß√£o estrita<br>- **Type Guards**: Valida√ß√µes de tipo em runtime quando necess√°rio<br><br>---<br><br>### 2.3 Vite 5.4.19<br><br>**Por que Vite (ao inv√©s de Create React App ou Webpack)?**<br>- ‚úÖ **Velocidade**: Dev server instant√¢neo com ES modules nativos<br>- ‚úÖ **Hot Module Replacement (HMR)**: Atualiza√ß√µes instant√¢neas<br>- ‚úÖ **Build Otimizado**: Rollup para produ√ß√£o = bundle menor<br>- ‚úÖ **Simples**: Zero config para maioria dos casos<br>- ‚úÖ **Moderno**: Suporta todas as features ES modernas<br><br>**Compara√ß√£o de Performance**:<br>| Ferramenta | Startup (cold) | HMR |<br>|------------|----------------|-----|<br>| CRA | ~30s | ~1s |<br>| Webpack | ~20s | ~500ms |<br>| **Vite** | **~500ms** | **~50ms** |<br><br>**Configura√ß√£o Customizada** (`vite.config.ts`):<br>```typescript<br>import { defineConfig } from 'vite'<br>import react from '@vitejs/plugin-react-swc'<br>import path from 'path'<br><br>export default defineConfig({<br>  plugins: [react()], // SWC = compila√ß√£o 20x mais r√°pida<br>  resolve: {<br>    alias: {<br>      '@': path.resolve(__dirname, './src') // Imports absolutos<br>    }<br>  },<br>  server: {<br>    port: 8080 // Porta customizada<br>  }<br>})<br>```<br><br>**Benef√≠cios Observados**:<br>- Server reinicia em < 1 segundo<br>- Mudan√ßas refletem instantaneamente no browser<br>- Build de produ√ß√£o 60% menor que Webpack<br><br>---<br><br>### 2.4 Tailwind CSS 3.4.17<br><br>**Por que Tailwind (ao inv√©s de CSS-in-JS ou Styled Components)?**<br>- ‚úÖ **Utility-First**: Classes pequenas e compon√≠veis<br>- ‚úÖ **  Bundle Size**: CSS n√£o usado √© removido (tree-shaking)<br>- ‚úÖ **Consist√™ncia**: Design system built-in<br>- ‚úÖ **Velocidade**: N√£o escreve CSS customizado, usa classes prontas<br>- ‚úÖ **Responsive**: Breakpoints simples (`md:`, `lg:`)<br>- ‚úÖ **Dark Mode**: Suporte nativo<br><br>**Configura√ß√£o Customizada** (`tailwind.config.ts`):<br>```typescript<br>export default {<br>  darkMode: ['class'], // Dark mode via classe<br>  content: [<br>    './pages/**/*.{ts,tsx}',<br>    './components/**/*.{ts,tsx}',<br>    './app/**/*.{ts,tsx}',<br>    './src/**/*.{ts,tsx}'<br>  ],<br>  theme: {<br>    extend: {<br>      colors: {<br>        border: 'hsl(var(--border))',<br>        // ... cores do shadcn/ui<br>      },<br>      fontFamily: {<br>        // Fontes customizadas<br>      },<br>      animation: {<br>        // Anima√ß√µes customizadas<br>      }<br>    }<br>  },<br>  plugins: [<br>    require('tailwindcss-animate'),<br>    require('@tailwindcss/typography')<br>  ]<br>}<br>```<br><br>**Exemplos de Uso no Projeto**:<br>```tsx<br>// ‚úÖ Responsive + Dark Mode<br><div className="<br>  grid grid-cols-1           // Mobile: 1 coluna<br>  md:grid-cols-2             // Tablet: 2 colunas<br>  lg:grid-cols-3             // Desktop: 3 colunas<br>  gap-6                      // Espa√ßamento<br>  dark:bg-slate-900          // Fundo no dark mode<br>"><br>  {/* conte√∫do */}<br></div><br><br>// ‚úÖ Hover effects<br><button className="<br>  bg-blue-600 <br>  hover:bg-blue-700          // Hover state<br>  transition-colors          // Transi√ß√£o suave<br>  duration-200<br>"><br>  Click me<br></button><br>```<br><br>---<br><br>### 2.5 shadcn/ui + Radix UI<br><br>**Por que shadcn/ui (ao inv√©s de Material-UI ou Ant Design)?**<br>- ‚úÖ **Copy-Paste**: Componentes copiados para seu projeto (n√£o NPM dependency)<br>- ‚úÖ **Customiza√ß√£o**: 100% customiz√°vel pois c√≥digo est√° no projeto<br>- ‚úÖ **Acessibilidade**: Built on Radix UI = WAI-ARIA compliant<br>- ‚úÖ **Tailwind Native**: Usa Tailwind, n√£o CSS-in-JS<br>- ‚úÖ **Headless**: L√≥gica separada de estilo<br><br>**Componentes Utilizados** (49 total):<br>- Dialog, Sheet, Popover: Modais e overlays<br>- Form, Input, Select, Textarea: Formul√°rios<br>- Toast: Notifica√ß√µes<br>- Tabs: Navega√ß√£o do Admin<br>- Card: Layout de conte√∫do<br>- Button: Call-to-actions<br>- Accordion: FAQ e se√ß√µes colaps√°veis<br>- ... e 40+ outros<br><br>**Como Adicionar Novo Componente**:<br>```bash<br># Instala CLI do shadcn/ui<br>npx shadcn-ui@latest init<br><br># Adiciona componente espec√≠fico<br>npx shadcn-ui@latest add dialog<br>npx shadcn-ui@latest add button<br><br># Componente agora est√° em src/components/ui/<br>```<br><br>**Exemplo de Customiza√ß√£o**:<br>```tsx<br>// src/components/ui/button.tsx (gerado pelo shadcn)<br>// VOC√ä PODE EDITAR LIVREMENTE!<br><br>const buttonVariants = cva(<br>  "inline-flex items-center justify-center rounded-md...",<br>  {<br>    variants: {<br>      variant: {<br>        default: "bg-primary text-primary-foreground",<br>        destructive: "bg-red-600 text-white", // ‚úÖ Customizado!<br>        // Adicione suas pr√≥prias variantes<br>      },<br>      size: {<br>        default: "h-10 px-4 py-2",<br>        sm: "h-9 px-3",<br>        lg: "h-11 px-8", // ‚úÖ Customizado!<br>      }<br>    }<br>  }<br>)<br>```<br><br>---<br><br>###  2.6 React Router DOM 6.30.1<br><br>**Por que React Router?**<br>- ‚úÖ **Standard**: Router mais usado no ecossistema React<br>- ‚úÖ **Nested Routes**: Rotas aninhadas f√°ceis<br>- ‚úÖ **Lazy Loading**: Code splitting por rota<br>- ‚úÖ **Hooks**: `useNavigate`, `useParams`, `useLocation`<br><br>**Implementa√ß√£o** (`src/App.tsx`):<br>```tsx<br>import { BrowserRouter, Routes, Route } from 'react-router-dom'<br><br>function App() {<br>  return (<br>    <BrowserRouter><br>      <Routes><br>        <Route path="/" element={<Index />} /><br>        <Route path="/photography" element={<Photography />} /><br>        <Route path="/design" element={<GraphicDesign />} /><br>        <Route path="/about" element={<AboutPage />} /><br>        <Route path="/admin" element={<Admin />} /><br>        <Route path="/contact" element={<Contact />} /><br>        <Route path="*" element={<NotFound />} /> {/* 404 */}<br>      </Routes><br>    </BrowserRouter><br>  )<br>}<br>```<br><br>**Navega√ß√£o Program√°tica**:<br>```typescript<br>import { useNavigate } from 'react-router-dom'<br><br>function MyComponent() {<br>  const navigate = useNavigate()<br>  <br>  const handleClick = () => {<br>    navigate('/photography') // Redireciona<br>  }<br>}<br>```<br><br>---<br><br>## 3. Backend - Supabase em Detalhes<br><br>### 3.1 Por que Supabase?<br><br>**Compara√ß√£o com Alternativas**:<br><br>| Feature | Supabase | Firebase | AWS Amplify | Backend Pr√≥prio |<br>|---------|----------|----------|-------------|-----------------|<br>| **Tipo de DB** | PostgreSQL | NoSQL | DynamoDB | Qualquer |<br>| **Relacional** | ‚úÖ Sim | ‚ùå N√£o | Limitado | ‚úÖ Sim |<br>| **Open Source** | ‚úÖ Sim | ‚ùå N√£o | Parcial | N/A |<br>| **Self-Host** | ‚úÖ Sim | ‚ùå N√£o | ‚ùå N√£o | ‚úÖ Sim |<br>| **SQL Direto** | ‚úÖ Sim | ‚ùå N√£o | ‚ùå N√£o | ‚úÖ Sim |<br>| **Pricing** | Generoso | Caro | M√©dio | Custo servidor |<br>| **Learning Curve** | Baixa | M√©dia | Alta | Alta |<br><br>**Por que  escolhemos Supabase**:<br>1. **PostgreSQL**: Banco relacional maduro e poderoso<br>2. **Row Level Security**: Seguran√ßa granular sem c√≥digo backend<br>3. **Realtime**: Subscriptions para updates em tempo real<br>4. **Storage**: Upload de arquivos built-in<br>5. **Auth**: Autentica√ß√£o completa out-of-the-box<br>6. **SQL**: Liberdade total para queries complexas<br>7. **Open Source**: Pode migrar para self-hosted se necess√°rio<br><br>---<br><br>### 3.2 Auth (Autentica√ß√£o)<br><br>**Implementa√ß√£o**:<br>```typescript<br>// src/hooks/useSupabaseData.ts<br><br>export function useAuth() {<br>  const [user, setUser] = useState(null)<br>  const [loading, setLoading] = useState(true)<br>  <br>  useEffect(() => {<br>    // Pega sess√£o atual<br>    supabase.auth.getSession().then(({ data: { session } }) => {<br>      setUser(session?.user ?? null)<br>      setLoading(false)<br>    })<br>    <br>    // Escuta mudan√ßas de auth<br>    const { data: { subscription } } = supabase.auth.onAuthStateChange(<br>      (_event, session) => {<br>        setUser(session?.user ?? null)<br>      }<br>    )<br>    <br>    return () => subscription.unsubscribe()<br>  }, [])<br>  <br>  const signIn = async (email: string, password: string) => {<br>    const { error } = await supabase.auth.signInWithPassword({<br>      email,<br>      password<br>    })<br>    return { error }<br>  }<br>  <br>  const signOut = async () => {<br>    await supabase.auth.signOut()<br>  }<br>  <br>  return { user, loading, signIn, signOut }<br>}<br>```<br><br>**Uso no Admin**:<br>```tsx<br>const Admin = () => {<br>  const { user, signIn, signOut } = useAuth()<br>  <br>  if (!user) {<br>    return <LoginForm onSubmit={signIn} /><br>  }<br>  <br>  return <AdminDashboard user={user} onLogout={signOut} /><br>}<br>```<br><br>**Benef√≠cios**:<br>- Sess√£o persistente (refresh tokens autom√°ticos)<br>- Seguro por padr√£o (bcrypt para senhas)<br>- Magic links, OAuth social (Google, GitHub) se necess√°rio<br><br>---<br><br>### 3.3 Row Level Security (RLS)<br><br>**O que √© RLS?**<br>Row Level Security permite definir pol√≠ticas de acesso a n√≠vel de linha no PostgreSQL. Cada query √© automaticamente filtrada pelas pol√≠ticas.<br><br>**Exemplo Pr√°tico**:<br>```sql<br>-- 1. Habilitar RLS na tabela<br>ALTER TABLE photography ENABLE ROW LEVEL SECURITY;<br><br>-- 2. Pol√≠tica: Qualquer um pode VER (SELECT)<br>CREATE POLICY "Leitura p√∫blica"<br>ON photography FOR SELECT<br>USING (true); -- true = sem restri√ß√µes<br><br>-- 3. Pol√≠tica: Apenas autenticados podem INSERIR<br>CREATE POLICY "Apenas admins inserem"<br>ON photography FOR INSERT<br>WITH CHECK (auth.role() = 'authenticated');<br><br>-- 4. Pol√≠tica: Apenas autenticados podem DELETAR<br>CREATE POLICY "Apenas admins deletam"<br>ON photography FOR DELETE<br>USING (auth.role() = 'authenticated');<br>```<br><br>**Como Funciona**:<br>```typescript<br>// Usu√°rio N√ÉO autenticado<br>const { data } = await supabase.from('photography').select('*')<br>// ‚úÖ Funciona! Pol√≠tica "Leitura p√∫blica" permite<br><br>await supabase.from('photography').insert({ title: 'Nova foto' })<br>// ‚ùå ERRO! Pol√≠tica "Apenas admins inserem" bloqueia<br><br>// Usu√°rio autenticado<br>await supabase.auth.signInWithPassword({ email, password })<br><br>await supabase.from('photography').insert({ title: 'Nova foto' })<br>// ‚úÖ Funciona! Agora auth.role() = 'authenticated'<br>```<br><br>**Vantagens do RLS**:<br>- ‚úÖ Seguran√ßa no banco, n√£o no c√≥digo<br>- ‚úÖ Imposs√≠vel burlar do cliente<br>- ‚úÖ C√≥digo do cliente mais simples<br><br>---<br><br>### 3.4 Storage (Buckets)<br><br>**Implementa√ß√£o de Upload**:<br>```typescript<br>// src/lib/supabase.ts<br><br>export async function uploadImage(<br>  bucket: string, <br>  file: File<br>): Promise<string> {<br>  // 1. Gera nome √∫nico para arquivo<br>  const fileExt = file.name.split('.').pop()<br>  const fileName = `${Math.random().toString(36).substring(2)}.${fileExt}`<br>  <br>  // 2. Upload para bucket<br>  const { data, error } = await supabase.storage<br>    .from(bucket)<br>    .upload(fileName, file)<br>  <br>  if (error) throw error<br>  <br>  // 3. Pega URL p√∫blica<br>  const { data: { publicUrl } } = supabase.storage<br>    .from(bucket)<br>    .getPublicUrl(fileName)<br>  <br>  return publicUrl<br>}<br>```<br><br>**Uso no Componente**:<br>```typescript<br>const handleUpload = async (file: File) => {<br>  try {<br>    // Upload da imagem<br>    const url = await uploadImage(PHOTOGRAPHY_BUCKET, file)<br>    <br>    // Salva URL no banco<br>    await supabase.from('photography').insert({<br>      title: 'Nova Foto',<br>      url: url, // URL do storage<br>      category: 'urban'<br>    })<br>  } catch (error) {<br>    console.error('Upload falhou:', error)<br>  }<br>}<br>```<br><br>**Pol√≠ticas de Storage**:<br>```sql<br>-- Permitir leitura p√∫blica de imagens<br>CREATE POLICY "Leitura p√∫blica de imagens"<br>ON storage.objects FOR SELECT<br>USING (bucket_id = 'photography');<br><br>-- Apenas autenticados podem upload<br>CREATE POLICY "Upload apenas autenticados"<br>ON storage.objects FOR INSERT<br>WITH CHECK (<br>  bucket_id = 'photography' AND <br>  auth.role() = 'authenticated'<br>);<br>```<br><br>---<br><br>## 4. Bibliotecas Especializadas<br><br>### 4.1 exifr - Extra√ß√£o de Metadados EXIF<br><br>**Por que exifr?**<br>- ‚úÖ **Completo**: Suporta todos os formados (JPEG, TIFF, HEIC)<br>- ‚úÖ **R√°pido**: Parser otimizado<br>- ‚úÖ **Leve**: ~50KB minified<br>- ‚úÖ **Privacy**: Pode desabilitar GPS<br><br>**Implementa√ß√£o** (`src/lib/exifExtractor.ts`):<br>```typescript<br>import exifr from 'exifr'<br><br>export async function extractExifData(file: File): Promise<ExifData> {<br>  const exif = await exifr.parse(file, {<br>    tiff: true,<br>    exif: true,<br>    gps: false // ‚ö†Ô∏è Desabilitado por privacidade!<br>  })<br>  <br>  if (!exif) return {}<br>  <br>  return {<br>    camera_make: exif.Make?.trim(),<br>    camera_model: exif.Model?.trim(),<br>    lens_model: exif.LensModel?.trim(),<br>    iso: exif.ISO,<br>    aperture: formatAperture(exif.FNumber),<br>    shutter_speed: formatShutterSpeed(exif.ExposureTime),<br>    focal_length: formatFocalLength(exif.FocalLength),<br>    capture_date: exif.DateTimeOriginal<br>  }<br>}<br><br>// Formata√ß√µes espec√≠ficas<br>function formatAperture(value?: number): string | undefined {<br>  if (!value) return undefined<br>  return `f/${value.toFixed(1)}` // f/2.8<br>}<br><br>function formatShutterSpeed(exposureTime?: number): string | undefined {<br>  if (!exposureTime) return undefined<br>  <br>  if (exposureTime >= 1) {<br>    return `${exposureTime}s` // 2s<br>  } else {<br>    const denominator = Math.round(1 / exposureTime)<br>    return `1/${denominator}s` // 1/250s<br>  }<br>}<br><br>function formatFocalLength(focalLength?: number): string | undefined {<br>  if (!focalLength) return undefined<br>  return `${Math.round(focalLength)}mm` // 50mm<br>}<br>```<br><br>**Uso no Upload**:<br>```tsx<br>const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {<br>  const file = e.target.files?.[0]<br>  if (!file) return<br>  <br>  // Extrai EXIF automaticamente<br>  const exifData = await extractExifData(file)<br>  <br>  // Preenche formul√°rio automaticamente<br>  setFormData({<br>    ...formData,<br>    file,<br>    description: formatExifAsDescription(exifData), // Descri√ß√£o formatada<br>    camera_make: exifData.camera_make,<br>    camera_model: exifData.camera_model,<br>    // ... outros campos<br>  })<br>}<br>```<br><br>**Resultado no Admin**:<br>Ao fazer upload de uma foto, o sistema automaticamente preenche:<br>```<br>üì∑ Canon EOS R5<br>üîç RF 24-70mm F2.8 L IS USM<br>‚öôÔ∏è 50mm  ‚Ä¢ f/2.8 ‚Ä¢ 1/250s ‚Ä¢ ISO 400<br>```<br><br>---<br><br>### 4.2 react-helmet-async - SEO<br><br>**Por que react-helmet-async?**<br>- ‚úÖ **SEO**: Meta tags din√¢micas por p√°gina<br>- ‚úÖ **SSR Ready**: Funciona com server-side rendering<br>- ‚úÖ **Async**: N√£o bloqueia render<br><br>**Implementa√ß√£o** (`src/components/SEO.tsx`):<br>```typescript<br>import { Helmet } from 'react-helmet-async'<br><br>interface SEOProps {<br>  title: string<br>  description: string<br>  image?: string<br>  url?: string<br>}<br><br>export function SEO({ title, description, image, url }: SEOProps) {<br>  const siteUrl = 'https://tiagodamasceno.com'<br>  const fullUrl = url ? `${siteUrl}${url}` : siteUrl<br>  const imageUrl = image || `${siteUrl}/og-image.png`<br>  <br>  return (<br>    <Helmet><br>      {/* Title */}<br>      <title>{title} | Tiago Damasceno</title><br>      <br>      {/* Meta tags b√°sicas */}<br>      <meta name="description" content={description} /><br>      <br>      {/* Open Graph (Facebook, LinkedIn) */}<br>      <meta property="og:type" content="website" /><br>      <meta property="og:url" content={fullUrl} /><br>      <meta property="og:title" content={title} /><br>      <meta property="og:description" content={description} /><br>      <meta property="og:image" content={imageUrl} /><br>      <br>      {/* Twitter Card */}<br>      <meta name="twitter:card" content="summary_large_image" /><br>      <meta name="twitter:title" content={title} /><br>      <meta name="twitter:description" content={description} /><br>      <meta name="twitter:image" content={imageUrl} /><br>      <br>      {/* Canonical */}<br>      <link rel="canonical" href={fullUrl} /><br>    </Helmet><br>  )<br>}<br>```<br><br>**Uso em P√°ginas**:<br>```tsx<br>// src/pages/Photography.tsx<br><br>function Photography() {<br>  return (<br>    <><br>      <SEO<br>        title="Fotografia"<br>        description="Confira meu portf√≥lio de fotografia profissional"<br>        url="/photography"<br>      /><br>      <br>      {/* Resto da p√°gina */}<br>    </><br>  )<br>}<br>```<br><br>**Resultado no HTML**:<br>```html<br><head><br>  <title>Fotografia | Tiago Damasceno</title><br>  <meta name="description" content="Confira meu portf√≥lio de fotografia profissional"><br>  <meta property="og:title" content="Fotografia"><br>  <!-- ... outras tags --><br></head><br>```<br><br>---<br><br>### 4.3 embla-carousel-react - Carross√©is<br><br>**Por que Embla?**<br>- ‚úÖ **Leve**: 2KB gzipped<br>- ‚úÖ **Touch/Swipe**: Funciona perfeitamente em mobile<br>- ‚úÖ **Plugins**: Autoplay, Fade, etc.<br>- ‚úÖ **Acess√≠vel**: Keyboard navigation<br><br>**Implementa√ß√£o** (`src/components/Hero.tsx`):<br>```tsx<br>import useEmblaCarousel from 'embla-carousel-react'<br>import Autoplay from 'embla-carousel-autoplay'<br>import Fade from 'embla-carousel-fade'<br><br>export function Hero({ images }: { images: HeroImage[] }) {<br>  const [emblaRef] = useEmblaCarousel(<br>    { loop: true }, // Op√ß√µes<br>    [<br>      Autoplay({ delay: 5000, stopOnInteraction: false }),<br>      Fade() // Transi√ß√£o fade<br>    ]<br>  )<br>  <br>  return (<br>    <div className="embla" ref={emblaRef}><br>      <div className="embla__container"><br>        {images.map((image) => (<br>          <div key={image.id} className="embla__slide"><br>            <img src={image.url} alt={image.title} /><br>          </div><br>        ))}<br>      </div><br>    </div><br>  )<br>}<br>```<br><br>---<br><br>## 5. Implementa√ß√µes Customizadas<br><br>### 5.1 Prote√ß√£o de Imagens<br><br>**Problema**: Usu√°rios podem facilmente baixar imagens (click direito, arrastar)<br><br>**Solu√ß√£o** (`src/hooks/useImageProtection.ts`):<br>```typescript<br>export function useImageProtection() {<br>  useEffect(() => {<br>    // Prevenir click direito<br>    const handleContextMenu = (e: MouseEvent) => {<br>      e.preventDefault()<br>      alert('Imagem protegida!')<br>    }<br>    <br>    // Prevenir arrastar imagem<br>    const handleDragStart = (e: DragEvent) => {<br>      e.preventDefault()<br>    }<br>    <br>    document.addEventListener('contextmenu', handleContextMenu)<br>    document.addEventListener('dragstart', handleDragStart)<br>    <br>    return () => {<br>      document.removeEventListener('contextmenu', handleContextMenu)<br>      document.removeEventListener('dragstart', handleDragStart)<br>    }<br>  }, [])<br>}<br>```<br><br>**Uso**:<br>```tsx<br>function ProtectedImage({ src, alt }: Props) {<br>  useImageProtection() // ‚úÖ Prote√ß√£o ativada<br>  <br>  return (<br>    <img <br>      src={src} <br>      alt={alt}<br>      className="select-none" // Previne sele√ß√£o<br>      draggable={false} // Previne arrastar<br>    /><br>  )<br>}<br>```<br><br>**Limita√ß√µes**:<br>- ‚ö†Ô∏è N√£o √© 100% √† prova de bots<br>- ‚ö†Ô∏è Screenshot ainda √© poss√≠vel<br>- ‚ö†Ô∏è Chrome DevTools pode acessar<br><br>**Melhorias Futuras**:<br>- Watermark invis√≠vel<br>- Servir imagens de baixa resolu√ß√£o<br>- DRM para imagens premium<br><br>---<br><br>### 5.2 Sistema de Busca<br><br>**Implementa√ß√£o** (`src/hooks/useSearch.ts`):<br>```typescript<br>export function useSearch<T>(<br>  items: T[],<br>  searchKeys: (keyof T)[]<br>) {<br>  const [searchTerm, setSearchTerm] = useState('')<br>  <br>  const filteredItems = useMemo(() => {<br>    if (!searchTerm.trim()) return items<br>    <br>    const term = searchTerm.toLowerCase()<br>    <br>    return items.filter((item) => {<br>      return searchKeys.some((key) => {<br>        const value = item[key]<br>        <br>        if (typeof value === 'string') {<br>          return value.toLowerCase().includes(term)<br>        }<br>        <br>        if (Array.isArray(value)) {<br>          return value.some((v) => <br>            String(v).toLowerCase().includes(term)<br>          )<br>        }<br>        <br>        return false<br>      })<br>    })<br>  }, [items, searchTerm, searchKeys])<br>  <br>  return { searchTerm, setSearchTerm, filteredItems }<br>}<br>```<br><br>**Uso**:<br>```tsx<br>function Photography() {<br>  const { photos } = usePhotography()<br>  const { searchTerm, setSearchTerm, filteredItems } = useSearch(<br>    photos,<br>    ['title', 'description', 'tags'] // Campos pesquis√°veis<br>  )<br>  <br>  return (<br>    <><br>      <SearchBar value={searchTerm} onChange={setSearchTerm} /><br>      <PhotoGrid photos={filteredItems} /><br>    </><br>  )<br>}<br>```<br><br>---<br><br>### 5.3 Internacionaliza√ß√£o (i18n)<br><br>**Implementa√ß√£o** (`src/contexts/LanguageContext.tsx`):<br>```typescript<br>type Language = 'pt-BR' | 'en'<br><br>const translations = {<br>  'pt-BR': {<br>    'nav.home': 'In√≠cio',<br>    'nav.photography': 'Fotografia',<br>    'nav.design': 'Design Gr√°fico',<br>    // ... mais tradu√ß√µes<br>  },<br>  'en': {<br>    'nav.home': 'Home',<br>    'nav.photography': 'Photography',<br>    'nav.design': 'Graphic Design',<br>  }<br>}<br><br>export const LanguageContext = createContext<{<br>  language: Language<br>  setLanguage: (lang: Language) => void<br>  t: (key: string) => string<br>}>()<br><br>export function LanguageProvider({ children }) {<br>  const [language, setLanguage] = useState<Language>('pt-BR')<br>  <br>  const t = (key: string) => {<br>    return translations[language][key] || key<br>  }<br>  <br>  return (<br>    <LanguageContext.Provider value={{ language, setLanguage, t }}><br>      {children}<br>    </LanguageContext.Provider><br>  )<br>}<br><br>export const useLanguage = () => useContext(LanguageContext)<br>```<br><br>**Uso**:<br>```tsx<br>function Navigation() {<br>  const { t } = useLanguage()<br>  <br>  return (<br>    <nav><br>      <Link to="/">{t('nav.home')}</Link><br>      <Link to="/photography">{t('nav.photography')}</Link><br>      <Link to="/design">{t('nav.design')}</Link><br>    </nav><br>  )<br>}<br>```<br><br>---<br><br>## 6. Padr√µes de C√≥digo e Best Practices<br><br>### 6.1 Estrutura de Componentes<br><br>**Padr√£o Seguido**:<br>```tsx<br>// 1. Imports<br>import { useState, useEffect } from 'react'<br>import { Button } from '@/components/ui/button'<br>import { usePhotography } from '@/hooks/useSupabaseData'<br><br>// 2. Types/Interfaces<br>interface PhotoGridProps {<br>  category?: string<br>  onPhotoClick?: (photo: PhotographyItem) => void<br>}<br><br>// 3. Component<br>export function PhotoGrid({ category, onPhotoClick }: PhotoGridProps) {<br>  // 3a. Hooks (ordem: state, effects, custom hooks)<br>  const [selectedId, setSelectedId] = useState<string | null>(null)<br>  const { photos, loading } = usePhotography(category)<br>  <br>  useEffect(() => {<br>    // side effects<br>  }, [])<br>  <br>  // 3b. Event handlers<br>  const handleClick = (photo: PhotographyItem) => {<br>    setSelectedId(photo.id)<br>    onPhotoClick?.(photo)<br>  }<br>  <br>  // 3c. Early returns<br>  if (loading) return <Loader /><br>  if (photos.length === 0) return <EmptyState /><br>  <br>  // 3d. Main render<br>  return (<br>    <div className="grid grid-cols-3 gap-4"><br>      {photos.map((photo) => (<br>        <PhotoCard<br>          key={photo.id}<br>          photo={photo}<br>          onClick={handleClick}<br>          selected={photo.id === selectedId}<br>        /><br>      ))}<br>    </div><br>  )<br>}<br>```<br><br>---<br><br>### 6.2 Naming Conventions<br><br>**Arquivos**:<br>- Componentes: `PascalCase.tsx` (ex: `PhotoGrid.tsx`)<br>- Hooks: `camelCase.ts` (ex: `useSupabaseData.ts`)<br>- Utils: `camelCase.ts` (ex: `formatDate.ts`)<br><br>**Vari√°veis**:<br>```typescript<br>// ‚úÖ BOM<br>const photoList = []<br>const isLoading = false<br>const handleClick = () => {}<br><br>// ‚ùå EVITE<br>const photo_list = [] // snake_case<br>const PHOTO_LIST = [] // SCREAMING_CASE para constantes<br>```<br><br>**Componentes**:<br>```typescript<br>// ‚úÖ BOM: Nome descritivo<br>function PhotoUploadButton() {}<br>function UserProfileCard() {}<br><br>// ‚ùå EVITE: Gen√©rico<br>function Button1() {}<br>function Component() {}<br>```<br><br>---<br><br>## 7. Guias de Implementa√ß√£o Espec√≠ficos<br><br>### 7.1 Como Adicionar Nova P√°gina<br><br>1. **Criar arquivo da p√°gina**:<br>```tsx<br>// src/pages/Services.tsx<br><br>import { SEO } from '@/components/SEO'<br><br>export function Services() {<br>  return (<br>    <><br>      <SEO<br>        title="Servi√ßos"<br>        description="Confira os servi√ßos de fotografia oferecidos"<br>        url="/services"<br>      /><br>      <br>      <div className="container mx-auto py-12"><br>        <h1>Meus  Servi√ßos</h1><br>        {/* conte√∫do */}<br>      </div><br>    </><br>  )<br>}<br>```<br><br>2. **Adicionar rota no App.tsx**:<br>```tsx<br>import { Services } from './pages/Services'<br><br><Route path="/services" element={<Services />} /><br>```<br><br>3. **Adicionar link na navega√ß√£o**:<br>```tsx<br>// src/components/Navigation.tsx<br><br><Link to="/services">Servi√ßos</Link><br>```<br><br>---<br><br>### 7.2 Como Adicionar Nova Tabela no Supabase<br><br>1. **Criar tabela via SQL**:<br>```sql<br>CREATE TABLE testimonials (<br>  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),<br>  client_name TEXT NOT NULL,<br>  content TEXT NOT NULL,<br>  rating INTEGER CHECK (rating >= 1 AND rating <= 5),<br>  created_at TIMESTAMPTZ DEFAULT NOW()<br>);<br>```<br><br>2. **Habilitar RLS**:<br>```sql<br>ALTER TABLE testimonials ENABLE ROW LEVEL SECURITY;<br><br>CREATE POLICY "Leitura p√∫blica"<br>ON testimonials FOR SELECT<br>USING (true);<br><br>CREATE POLICY "Admin insere"<br>ON testimonials FOR INSERT<br>WITH CHECK (auth.role() = 'authenticated');<br>```<br><br>3. **Criar interface TypeScript**:<br>```typescript<br>// src/lib/supabase.ts<br><br>export interface Testimonial {<br>  id: string<br>  client_name: string<br>  content: string<br>  rating: number<br>  created_at: string<br>}<br>```<br><br>4. **Criar hook**:<br>```typescript<br>// src/hooks/useSupabaseData.ts<br><br>export function useTestimonials() {<br>  const [testimonials, setTestimonials] = useState<Testimonial[]>([])<br>  const [loading, setLoading] = useState(true)<br>  <br>  useEffect(() => {<br>    fetchTestimonials()<br>  }, [])<br>  <br>  const fetchTestimonials = async () => {<br>    const { data } = await supabase<br>      .from('testimonials')<br>      .select('*')<br>      .order('created_at', { ascending: false })<br>    <br>    if (data) setTestimonials(data)<br>    setLoading(false)<br>  }<br>  <br>  return { testimonials, loading, refresh: fetchTestimonials }<br>}<br>```<br><br>---<br><br>### 7.3 Como Adicionar Upload de Novo Tipo de Arquivo<br><br>1. **Criar bucket no Supabase**:<br>   - Storage > New Bucket > "documents"<br>   - Marcar como p√∫blico se necess√°rio<br><br>2. **Adicionar constante**:<br>```typescript<br>// src/lib/supabase.ts<br><br>export const DOCUMENTS_BUCKET = 'documents'<br>```<br><br>3. **Criar fun√ß√£o de upload espec√≠fica (se necess√°rio)**:<br>```typescript<br>export async function uploadDocument(file: File): Promise<string> {<br>  // Valida√ß√£o de tipo<br>  const allowedTypes = ['application/pdf', 'application/msword']<br>  if (!allowedTypes.includes(file.type)) {<br>    throw new Error('Tipo de arquivo n√£o permitido')<br>  }<br>  <br>  // Valida√ß√£o de tamanho (ex: max 10MB)<br>  if (file.size > 10 * 1024 * 1024) {<br>    throw new Error('Arquivo muito grande (m√°x 10MB)')<br>  }<br>  <br>  return uploadImage(DOCUMENTS_BUCKET, file)<br>}<br>```<br><br>---<br><br>## üìö Recursos de Aprendizado<br><br>### Documenta√ß√£o Oficial<br>- [React](https://react.dev/)<br>- [TypeScript](https://www.typescriptlang.org/docs/)<br>- [Vite](https://vitejs.dev/)<br>- [Tailwind CSS](https://tailwindcss.com/docs)<br>- [Supabase](https://supabase.com/docs)<br>- [shadcn/ui](https://ui.shadcn.com/)<br><br>### Tutoriais Recomendados<br>- Supabase Auth: https://supabase.com/docs/guides/auth<br>- Row Level Security: https://supabase.com/docs/guides/auth/row-level-security<br>- React Hooks: https://react.dev/reference/react<br><br>---<br><br>**Documento criado em**: 30 de Novembro de 2025  <br>**Vers√£o**: 1.0.0<br><br>*Este guia complementa a documenta√ß√£o principal com detalhes t√©cnicos, orienta√ß√µes e justificativas para cada escolha tecnol√≥gica.*<br># Database Schema & Documenta√ß√£o de Ferramentas<br>## Portfolio de Fotografia - Banco de Dados Completo<br><br>---<br><br>## üìã √çndice<br><br>1. [Links de Documenta√ß√£o Oficial](#1-links-de-documenta√ß√£o-oficial)<br>2. [Vis√£o Geral do Banco de Dados](#2-vis√£o-geral-do-banco-de-dados)<br>3. [Schemas Completos das Tabelas](#3-schemas-completos-das-tabelas)<br>4. [Relacionamentos entre Tabelas](#4-relacionamentos-entre-tabelas)<br>5. [Pol√≠ticas de Seguran√ßa (RLS)](#5-pol√≠ticas-de-seguran√ßa-rls)<br>6. [Triggers e Functions](#6-triggers-e-functions)<br>7. [√çndices e Otimiza√ß√µes](#7-√≠ndices-e-otimiza√ß√µes)<br><br>---<br><br>## 1. Links de Documenta√ß√£o Oficial<br><br>### üõ† Frontend Technologies<br><br>| Ferramenta | Vers√£o | Documenta√ß√£o Oficial | Guia de In√≠cio |<br>|------------|--------|----------------------|----------------|<br>| **React** | 18.3.1 | [https://react.dev/](https://react.dev/) | [Learn React](https://react.dev/learn) |<br>| **TypeScript** | 5.8.3 | [https://www.typescriptlang.org/docs/](https://www.typescriptlang.org/docs/) | [Handbook](https://www.typescriptlang.org/docs/handbook/intro.html) |<br>| **Vite** | 5.4.19 | [https://vitejs.dev/](https://vitejs.dev/) | [Getting Started](https://vitejs.dev/guide/) |<br>| **Tailwind CSS** | 3.4.17 | [https://tailwindcss.com/docs](https://tailwindcss.com/docs) | [Installation](https://tailwindcss.com/docs/installation) |<br>| **React Router** | 6.30.1 | [https://reactrouter. com/](https://reactrouter.com/) | [Tutorial](https://reactrouter.com/en/main/start/tutorial) |<br><br>###  Backend & Database<br><br>| Ferramenta | Documenta√ß√£o Oficial | Guias Importantes |<br>|------------|----------------------|-------------------|<br>| **Supabase** | [https://supabase.com/docs](https://supabase.com/docs) | [Quickstart](https://supabase.com/docs/guides/getting-started) |<br>| **PostgreSQL** | [https://www.postgresql.org/docs/](https://www.postgresql.org/docs/) | [Tutorial](https://www.postgresql.org/docs/current/tutorial.html) |<br>| **Supabase Auth** | [Auth Docs](https://supabase.com/docs/guides/auth) | [Row Level Security](https://supabase.com/docs/guides/auth/row-level-security) |<br>| **Supabase Storage** | [Storage Docs](https://supabase.com/docs/guides/storage) | [CDN & Images](https://supabase.com/docs/guides/storage/serving/image-transformations) |<br><br>### üìö UI & Component Libraries<br><br>| Biblioteca | Documenta√ß√£o | Uso no Projeto |<br>|------------|--------------|----------------|<br>| **shadcn/ui** | [https://ui.shadcn.com/](https://ui.shadcn.com/) | 49 componentes UI |<br>| **Radix UI** | [https://www.radix-ui.com/](https://www.radix-ui.com/) | Base do shadcn/ui |<br>| **Lucide Icons** | [https://lucide.dev/](https://lucide.dev/) | √çcones SVG |<br>| **Embla Carousel** | [https://www.embla-carousel.com/](https://www.embla-carousel.com/) | Carross√©is de imagens |<br><br>### üîß Specialized Libraries<br><br>| Biblioteca | Vers√£o | Documenta√ß√£o | Prop√≥sito no Projeto |<br>|------------|--------|--------------|----------------------|<br>| **exifr** | 7.1.3 | [https://mutiny.cz/exifr/](https://mutiny.cz/exifr/) | Extra√ß√£o de metadados EXIF |<br>| **react-helmet-async** | 2.0.5 | [GitHub](https://github.com/staylor/react-helmet-async) | SEO meta tags |<br>| **react-hook-form** | 7.61.1 | [https://react-hook-form.com/](https://react-hook-form.com/) | Gerenciamento de formul√°rios |<br>| **zod** | 3.25.76 | [https://zod.dev/](https://zod.dev/) | Valida√ß√£o de schemas |<br>| **@tanstack/react-query** | 5.83.0 | [https://tanstack.com/query/](https://tanstack.com/query/) | Cache e sincroniza√ß√£o |<br>| **date-fns** | 3.6.0 | [https://date-fns.org/](https://date-fns.org/) | Manipula√ß√£o de datas |<br><br>---<br><br>## 2. Vis√£o Geral do Banco de Dados<br><br>### 2.1 Resumo das Tabelas<br><br>| Tabela | Prop√≥sito | Linhas (estimado) | Relacionamentos |<br>|--------|-----------|-------------------|-----------------|<br>| **photography** | Armazena fotografias do portf√≥lio | Centenas | ‚Üí comments |<br>| **design_projects** | Projetos de design gr√°fico | Dezenas | ‚Üí comments |<br>| **comments** | Coment√°rios em fotos/projetos | Centenas | ‚Üê photography, design_projects |<br>| **hero_images** | Imagens do banner principal | 5-10 | Nenhum |<br>| **site_content** | Textos do site (i18n) | ~180 | Nenhum |<br><br>### 2.2 Diagrama ER (Entity-Relationship)<br><br>```mermaid<br>erDiagram<br>    photography ||--o{ comments : "has"<br>    design_projects ||--o{ comments : "has"<br>    comments ||--o{ comments : "replies to"<br>    <br>    photography {<br>        uuid id PK<br>        text title<br>        text category<br>        text url<br>        text description<br>        int year<br>        text event_name<br>        date event_date<br>        text[] tags<br>        text camera_make<br>        text camera_model<br>        int iso<br>        text aperture<br>        int likes_count<br>        int comments_count<br>        int shares_count<br>        timestamp created_at<br>    }<br>    <br>    design_projects {<br>        uuid id PK<br>        text title<br>        text category<br>        text description<br>        text[] images<br>        text client<br>        int year<br>        text[] tags<br>        int likes_count<br>        int comments_count<br>        int shares_count<br>        timestamp created_at<br>    }<br>    <br>    comments {<br>        uuid id PK<br>        text content<br>        text user_name<br>        uuid photo_id FK<br>        uuid project_id FK<br>        uuid parent_id FK<br>        boolean approved<br>        boolean is_admin<br>        timestamp created_at<br>    }<br>    <br>    hero_images {<br>        uuid id PK<br>        text url<br>        text title<br>        boolean active<br>        text page<br>        timestamp created_at<br>    }<br>    <br>    site_content {<br>        text key PK<br>        text lang PK<br>        text value<br>        timestamp created_at<br>    }<br>```<br><br>---<br><br>## 3. Schemas Completos das Tabelas<br><br>### 3.1 Tabela: `photography`<br><br>**Prop√≥sito**: Armazena todas as fotografias do portf√≥lio com metadados completos<br><br>```sql<br>CREATE TABLE photography (<br>  -- Identificadores<br>  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,<br>  <br>  -- Informa√ß√µes B√°sicas<br>  title TEXT NOT NULL,<br>  category TEXT CHECK (category IN ('portraits', 'urban', 'nature', 'art', 'events')),<br>  url TEXT NOT NULL, -- URL da imagem no Supabase Storage<br>  description TEXT,<br>  year INTEGER,<br>  <br>  -- Informa√ß√µes de Eventos (opcional)<br>  event_name TEXT,<br>  event_date DATE,<br>  <br>  -- Tags para busca<br>  tags TEXT[], -- Array de strings<br>  <br>  -- Metadados EXIF (extra√≠dos automaticamente)<br>  camera_make TEXT,       -- Ex: "Canon"<br>  camera_model TEXT,      -- Ex: "EOS R5"<br>  lens_model TEXT,        -- Ex: "RF 24-70mm F2.8 L IS USM"<br>  iso INTEGER,            -- Ex: 400<br>  aperture TEXT,          -- Ex: "f/2.8"<br>  shutter_speed TEXT,     -- Ex: "1/250s"<br>  focal_length TEXT,      -- Ex: "50mm"<br>  capture_date TIMESTAMP WITH TIME ZONE, -- Data da captura original<br>  <br>  -- Intera√ß√µes Sociais<br>  likes_count INTEGER DEFAULT 0 NOT NULL,<br>  comments_count INTEGER DEFAULT 0 NOT NULL,<br>  shares_count INTEGER DEFAULT 0 NOT NULL,<br>  <br>  -- Timestamps<br>  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL,<br>  updated_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL<br>);<br><br>-- √çndices para performance<br>CREATE INDEX idx_photography_category ON photography(category);<br>CREATE INDEX idx_photography_year ON photography(year);<br>CREATE INDEX idx_photography_created_at ON photography(created_at DESC);<br>CREATE INDEX idx_photography_tags ON photography USING GIN(tags); -- GIN index para arrays<br><br>-- Habilitar Row Level Security<br>ALTER TABLE photography ENABLE ROW LEVEL SECURITY;<br>```<br><br>**Dados de Exemplo**:<br>```sql<br>INSERT INTO photography (title, category, url, description, year, tags, camera_make, camera_model, iso) VALUES<br>(<br>  'Retrato em Est√∫dio',<br>  'portraits',<br>  'https://xxxxx.supabase.co/storage/v1/object/public/photography/abc123.jpg',<br>  'üì∑ Canon EOS R5\nüîç RF 85mm F1.2 L USM\n‚öôÔ∏è 85mm ‚Ä¢ f/1.8 ‚Ä¢ 1/125s ‚Ä¢ ISO 200',<br>  2024,<br>  ARRAY['retrato', 'est√∫dio', 'comercial'],<br>  'Canon',<br>  'EOS R5',<br>  200<br>);<br>```<br><br>---<br><br>### 3.2 Tabela: `design_projects`<br><br>**Prop√≥sito**: Armazena projetos de design gr√°fico com m√∫ltiplas imagens<br><br>```sql<br>CREATE TABLE design_projects (<br>  -- Identificadores<br>  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,<br>  <br>  -- Informa√ß√µes B√°sicas<br>  title TEXT NOT NULL,<br>  category TEXT CHECK (category IN ('branding', 'editorial', 'web', 'illustration', 'packaging')),<br>  description TEXT NOT NULL,<br>  <br>  -- Imagens (array de URLs)<br>  images TEXT[] NOT NULL, -- M√∫ltiplas imagens por projeto<br>  <br>  -- Informa√ß√µes do Projeto<br>  client TEXT, -- Nome do cliente (opcional)<br>  year INTEGER,<br>  link TEXT, -- Link externo (portfolio, behance, etc)<br>  <br>  -- Informa√ß√µes de Eventos (opcional)<br>  event_name TEXT,<br>  event_date DATE,<br>  <br>  -- Tags para busca<br>  tags TEXT[],<br>  <br>  -- Intera√ß√µes Sociais<br>  likes_count INTEGER DEFAULT 0 NOT NULL,<br>  comments_count INTEGER DEFAULT 0 NOT NULL,<br>  shares_count INTEGER DEFAULT 0 NOT NULL,<br>  <br>  -- Timestamps<br>  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL,<br>  updated_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL<br>);<br><br>-- √çndices<br>CREATE INDEX idx_design_category ON design_projects(category);<br>CREATE INDEX idx_design_year ON design_projects(year);<br>CREATE INDEX idx_design_created_at ON design_projects(created_at DESC);<br>CREATE INDEX idx_design_tags ON design_projects USING GIN(tags);<br><br>-- Habilitar Row Level Security<br>ALTER TABLE design_projects ENABLE ROW LEVEL SECURITY;<br>```<br><br>**Dados de Exemplo**:<br>```sql<br>INSERT INTO design_projects (title, category, description, images, client, year, tags) VALUES<br>(<br>  'Identidade Visual - Caf√© Moderna',<br>  'branding',<br>  'Desenvolvimento completo de identidade visual para cafeteria moderna, incluindo logo, paleta de cores, tipografia e aplica√ß√µes.',<br>  ARRAY[<br>    'https://xxxxx.supabase.co/storage/v1/object/public/design/logo.jpg',<br>    'https://xxxxx.supabase.co/storage/v1/object/public/design/brand-guide.jpg',<br>    'https://xxxxx.supabase.co/storage/v1/object/public/design/mockups.jpg'<br>  ],<br>  'Caf√© Moderna',<br>  2024,<br>  ARRAY['branding', 'identidade visual', 'logo', 'caf√©']<br>);<br>```<br><br>---<br><br>### 3.3 Tabela: `comments`<br><br>**Prop√≥sito**: Sistema de coment√°rios com modera√ß√£o, respostas e suporte a threads<br><br>```sql<br>CREATE TABLE comments (<br>  -- Identificadores<br>  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,<br>  <br>  -- Conte√∫do<br>  content TEXT NOT NULL,<br>  user_name TEXT NOT NULL DEFAULT 'Anonymous',<br>  <br>  -- Rela√ß√µes (exclusivas - ou foto OU projeto)<br>  photo_id UUID REFERENCES photography(id) ON DELETE CASCADE,<br>  project_id UUID REFERENCES design_projects(id) ON DELETE CASCADE,<br>  <br>  -- Sistema de Respostas (threading)<br>  parent_id UUID REFERENCES comments(id) ON DELETE CASCADE, -- NULL = coment√°rio raiz<br>  <br>  -- Modera√ß√£o<br>  approved BOOLEAN DEFAULT FALSE NOT NULL, -- Coment√°rios precisam ser aprovados<br>  is_admin BOOLEAN DEFAULT FALSE NOT NULL, -- Marca respostas do administrador<br>  <br>  -- Timestamp<br>  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL,<br>  <br>  -- Constraints<br>  CONSTRAINT comments_item_check CHECK (<br>    (photo_id IS NOT NULL AND project_id IS NULL) OR<br>    (photo_id IS NULL AND project_id IS NOT NULL)<br>  ) -- Garante que comenta em FOTO ou PROJETO, n√£o ambos<br>);<br><br>-- √çndices<br>CREATE INDEX idx_comments_photo_id ON comments(photo_id);<br>CREATE INDEX idx_comments_project_id ON comments(project_id);<br>CREATE INDEX idx_comments_parent_id ON comments(parent_id);<br>CREATE INDEX idx_comments_approved ON comments(approved);<br>CREATE INDEX idx_comments_created_at ON comments(created_at DESC);<br><br>-- Habilitar Row Level Security<br>ALTER TABLE comments ENABLE ROW LEVEL SECURITY;<br>```<br><br>**Dados de Exemplo**:<br>```sql<br>-- Coment√°rio raiz<br>INSERT INTO comments (content, user_name, photo_id, approved) VALUES<br>('Foto incr√≠vel! Adorei a composi√ß√£o.', 'Jo√£o Silva', 'uuid-da-foto', true);<br><br>-- Resposta do admin<br>INSERT INTO comments (content, user_name, photo_id, parent_id, approved, is_admin) VALUES<br>('Obrigado! üòä', 'Tiago', 'uuid-da-foto', 'uuid-do-comentario-acima', true, true);<br>```<br><br>---<br><br>### 3.4 Tabela: `hero_images`<br><br>**Prop√≥sito**: Gerencia imagens do banner hero/carousel da homepage<br><br>```sql<br>CREATE TABLE hero_images (<br>  -- Identificadores<br>  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,<br>  <br>  -- Imagem<br>  url TEXT NOT NULL, -- URL no Supabase Storage<br>  title TEXT NOT NULL, -- T√≠tulo de refer√™ncia (n√£o exibido no site)<br>  <br>  -- Status<br>  active BOOLEAN DEFAULT TRUE NOT NULL, -- Imagem est√° ativa?<br>  page TEXT, -- Opcional: 'home', 'photography', 'design' (para diferentes p√°ginas)<br>  <br>  -- Timestamp<br>  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL<br>);<br><br>-- √çndice<br>CREATE INDEX idx_hero_active ON hero_images(active) WHERE active = true;<br><br>-- Habilitar Row Level Security<br>ALTER TABLE hero_images ENABLE ROW LEVEL SECURITY;<br>```<br><br>**Dados de Exemplo**:<br>```sql<br>INSERT INTO hero_images (url, title, active, page) VALUES<br>('https://xxxxx.supabase.co/storage/v1/object/public/hero/hero1.jpg', 'Paisagem Urbana', true, 'home'),<br>('https://xxxxx.supabase.co/storage/v1/object/public/hero/hero2.jpg', 'Retrato Profissional', true, 'home'),<br>('https://xxxxx.supabase.co/storage/v1/object/public/hero/hero3.jpg', 'Projeto de Design', false, 'home');<br>```<br><br>---<br><br>### 3.5 Tabela: `site_content`<br><br>**Prop√≥sito**: Sistema de CMS para internacionaliza√ß√£o (i18n) de textos do site<br><br>```sql<br>CREATE TABLE site_content (<br>  -- Chaves Compostas<br>  key TEXT NOT NULL,   -- Ex: 'nav.home', 'hero.title'<br>  lang TEXT NOT NULL,  -- Ex: 'pt', 'en'<br>  <br>  -- Valor<br>  value TEXT NOT NULL, -- Texto traduzido<br>  <br>  -- Timestamp<br>  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL,<br>  <br>  -- Primary Key Composta<br>  PRIMARY KEY (key, lang)<br>);<br><br>-- √çndice para busca por idioma<br>CREATE INDEX idx_site_content_lang ON site_content(lang);<br><br>-- Habilitar Row Level Security<br>ALTER TABLE site_content ENABLE ROW LEVEL SECURITY;<br>```<br><br>**Dados de Exemplo**:<br>```sql<br>-- Portugu√™s<br>INSERT INTO site_content (key, lang, value) VALUES<br>('nav.home', 'pt', 'In√≠cio'),<br>('nav.photography', 'pt', 'Fotografia'),<br>('nav.design', 'pt', 'Design Gr√°fico'),<br>('hero.title', 'pt', 'Tiago Damasceno'),<br>('hero.subtitle', 'pt', 'Fot√≥grafo & Designer Gr√°fico');<br><br>-- Ingl√™s<br>INSERT INTO site_content (key, lang, value) VALUES<br>('nav.home', 'en', 'Home'),<br>('nav.photography', 'en', 'Photography'),<br>('nav.design', 'en', 'Graphic Design'),<br>('hero.title', 'en', 'Tiago Damasceno'),<br>('hero.subtitle', 'en', 'Photographer & Graphic Designer');<br>```<br><br>**Uso no Frontend**:<br>```typescript<br>const { t } = useLanguage() // Hook do contexto de idioma<br><br><h1>{t('hero.title')}</h1> // Renderiza "Tiago Damasceno"<br><h2>{t('hero.subtitle')}</h2> // PT: "Fot√≥grafo & Designer Gr√°fico"<br>                               // EN: "Photographer & Graphic Designer"<br>```<br><br>---<br><br>## 4. Relacionamentos entre Tabelas<br><br>### 4.1 Diagrama de Relacionamentos Detalhado<br><br>```<br>photography (1) ---- (*) comments<br>    |<br>    ‚îî‚îÄ photo_id FK<br><br>design_projects (1) ---- (*) comments<br>    |<br>    ‚îî‚îÄ project_id FK<br><br>comments (1) ---- (*) comments (self-reference)<br>    |<br>    ‚îî‚îÄ parent_id FK (para respostas/threads)<br>```<br><br>### 4.2 Foreign Keys e Cascades<br><br>```sql<br>-- Coment√°rios em Fotografias<br>ALTER TABLE comments<br>ADD CONSTRAINT fk_comments_photo<br>FOREIGN KEY (photo_id)<br>REFERENCES photography(id)<br>ON DELETE CASCADE; -- Deleta coment√°rios se foto for deletada<br><br>-- Coment√°rios em Projetos<br>ALTER TABLE comments<br>ADD CONSTRAINT fk_comments_project<br>FOREIGN KEY (project_id)<br>REFERENCES design_projects(id)<br>ON DELETE CASCADE;<br><br>-- Respostas a Coment√°rios (threading)<br>ALTER TABLE comments<br>ADD CONSTRAINT fk_comments_parent<br>FOREIGN KEY (parent_id)<br>REFERENCES comments(id)<br>ON DELETE CASCADE; -- Deleta respostas se coment√°rio pai for deletado<br>```<br><br>---<br><br>## 5. Pol√≠ticas de Seguran√ßa (RLS)<br><br>### 5.1 Pol√≠ticas para `photography`<br><br>```sql<br>-- 1. Leitura P√∫blica (SELECT)<br>CREATE POLICY "Leitura p√∫blica de fotografia"<br>ON photography FOR SELECT<br>USING (true); -- Qualquer um pode ver<br><br>-- 2. Inser√ß√£o apenas Autenticados (INSERT)<br>CREATE POLICY "Apenas autenticados inserem"<br>ON photography FOR INSERT<br>WITH CHECK (auth.role() = 'authenticated');<br><br>-- 3. Atualiza√ß√£o apenas Autenticados (UPDATE)<br>CREATE POLICY "Apenas autenticados atualizam"<br>ON photography FOR UPDATE<br>USING (auth.role() = 'authenticated');<br><br>-- 4. Dele√ß√£o apenas Autenticados (DELETE)<br>CREATE POLICY "Apenas autenticados deletam"<br>ON photography FOR DELETE<br>USING (auth.role() = 'authenticated');<br>```<br><br>### 5.2 Pol√≠ticas para `design_projects`<br><br>```sql<br>-- Id√™nticas √†s de photography<br>CREATE POLICY "Leitura p√∫blica de projetos"<br>ON design_projects FOR SELECT<br>USING (true);<br><br>CREATE POLICY "Apenas autenticados inserem projetos"<br>ON design_projects FOR INSERT<br>WITH CHECK (auth.role() = 'authenticated');<br><br>CREATE POLICY "Apenas autenticados atualizam projetos"<br>ON design_projects FOR UPDATE<br>USING (auth.role() = 'authenticated');<br><br>CREATE POLICY "Apenas autenticados deletam projetos"<br>ON design_projects FOR DELETE<br>USING (auth.role() = 'authenticated');<br>```<br><br>### 5.3 Pol√≠ticas para `comments` (com Modera√ß√£o)<br><br>```sql<br>-- 1. SELECT: P√∫blico v√™ apenas aprovados, Admin v√™ tudo<br>CREATE POLICY "P√∫blico v√™ coment√°rios aprovados"<br>ON comments FOR SELECT<br>USING (approved = true);<br><br>CREATE POLICY "Admin v√™ todos os coment√°rios"<br>ON comments FOR SELECT<br>USING (auth.role() = 'authenticated');<br><br>-- 2. INSERT: Qualquer um pode comentar (mas ficar√° pendente)<br>CREATE POLICY "Qualquer um pode comentar"<br>ON comments FOR INSERT<br>WITH CHECK (true); -- approved ser√° FALSE por padr√£o<br><br>-- 3. UPDATE: Apenas admin (para aprovar/rejeitar)<br>CREATE POLICY "Admin aprova coment√°rios"<br>ON comments FOR UPDATE<br>USING (auth.role() = 'authenticated');<br><br>-- 4. DELETE: Apenas admin<br>CREATE POLICY "Admin deleta coment√°rios"<br>ON comments FOR DELETE<br>USING (auth.role() = 'authenticated');<br>```<br><br>### 5.4 Pol√≠ticas para `hero_images` e `site_content`<br><br>```sql<br>-- Hero Images: Leitura p√∫blica, admin gerencia<br>CREATE POLICY "Leitura p√∫blica de hero"<br>ON hero_images FOR SELECT<br>USING (true);<br><br>CREATE POLICY "Admin gerencia hero"<br>ON hero_images FOR ALL<br>USING (auth.role() = 'authenticated');<br><br>-- Site Content: Leitura p√∫blica, admin gerencia<br>CREATE POLICY "Leitura p√∫blica de conte√∫do"<br>ON site_content FOR SELECT<br>USING (true);<br><br>CREATE POLICY "Admin gerencia conte√∫do"<br>ON site_content FOR ALL<br>USING (auth.role() = 'authenticated');<br>```<br><br>---<br><br>## 6. Triggers e Functions<br><br>### 6.1 Trigger: Atualizar Contador de Coment√°rios<br><br>```sql<br>-- Function que atualiza contadores<br>CREATE OR REPLACE FUNCTION update_comments_count()<br>RETURNS TRIGGER AS $$<br>BEGIN<br>  -- Ao aprovar/adicionar coment√°rio, atualiza contador<br>  IF (TG_OP = 'INSERT' AND NEW.approved = true) OR<br>     (TG_OP = 'UPDATE' AND OLD.approved = false AND NEW.approved = true) THEN<br>    <br>    -- Incrementa contador na tabela pai<br>    IF NEW.photo_id IS NOT NULL THEN<br>      UPDATE photography<br>      SET comments_count = comments_count + 1<br>      WHERE id = NEW.photo_id;<br>    END IF;<br>    <br>    IF NEW.project_id IS NOT NULL THEN<br>      UPDATE design_projects<br>      SET comments_count = comments_count + 1<br>      WHERE id = NEW.project_id;<br>    END IF;<br>  END IF;<br>  <br>  -- Ao deletar coment√°rio aprovado, decrementa<br>  IF TG_OP = 'DELETE' AND OLD.approved = true THEN<br>    IF OLD.photo_id IS NOT NULL THEN<br>      UPDATE photography<br>      SET comments_count = GREATEST(comments_count - 1, 0)<br>      WHERE id = OLD.photo_id;<br>    END IF;<br>    <br>    IF OLD.project_id IS NOT NULL THEN<br>      UPDATE design_projects<br>      SET comments_count = GREATEST(comments_count - 1, 0)<br>      WHERE id = OLD.project_id;<br>    END IF;<br>  END IF;<br>  <br>  RETURN NEW;<br>END;<br>$$ LANGUAGE plpgsql;<br><br>-- Trigger<br>CREATE TRIGGER comments_count_trigger<br>AFTER INSERT OR UPDATE OR DELETE ON comments<br>FOR EACH ROW<br>EXECUTE FUNCTION update_comments_count();<br>```<br><br>### 6.2 Trigger: Atualizar `updated_at`<br><br>```sql<br>CREATE OR REPLACE FUNCTION update_modified_column()<br>RETURNS TRIGGER AS $$<br>BEGIN<br>  NEW.updated_at = timezone('utc'::text, now());<br>  RETURN NEW;<br>END;<br>$$ LANGUAGE plpgsql;<br><br>-- Aplicar em todas as tabelas relevantes<br>CREATE TRIGGER update_photography_modtime<br>BEFORE UPDATE ON photography<br>FOR EACH ROW<br>EXECUTE FUNCTION update_modified_column();<br><br>CREATE TRIGGER update_design_modtime<br>BEFORE UPDATE ON design_projects<br>FOR EACH ROW<br>EXECUTE FUNCTION update_modified_column();<br>```<br><br>---<br><br>## 7. √çndices e Otimiza√ß√µes<br><br>### 7.1 √çndices de Performance<br><br>```sql<br>-- Photography: busca por categoria, ano, tags<br>CREATE INDEX idx_photography_category ON photography(category);<br>CREATE INDEX idx_photography_year ON photography(year);<br>CREATE INDEX idx_photography_created_at ON photography(created_at DESC);<br>CREATE INDEX idx_photography_tags ON photography USING GIN(tags); -- GIN para arrays<br><br>-- Design: similar<br>CREATE INDEX idx_design_category ON design_projects(category);<br>CREATE INDEX idx_design_year ON design_projects(year);<br>CREATE INDEX idx_design_created_at ON design_projects(created_at DESC);<br>CREATE INDEX idx_design_tags ON design_projects USING GIN(tags);<br><br>-- Comments: busca por item e status<br>CREATE INDEX idx_comments_photo_id ON comments(photo_id);<br>CREATE INDEX idx_comments_project_id ON comments(project_id);<br>CREATE INDEX idx_comments_approved ON comments(approved);<br>CREATE INDEX idx_comments_parent_id ON comments(parent_id); -- Para threads<br>```<br><br>### 7.2 Full-Text Search (Futura Implementa√ß√£o)<br><br>```sql<br>-- Adicionar coluna de busca full-text (tsvector)<br>ALTER TABLE photography<br>ADD COLUMN tsv tsvector<br>GENERATED ALWAYS AS (<br>  to_tsvector('portuguese',<br>    coalesce(title, '') || ' ' ||<br>    coalesce(description, '') || ' ' ||<br>    coalesce(array_to_string(tags, ' '), '')<br>  )<br>) STORED;<br><br>-- √çndice GIN para full-text search<br>CREATE INDEX idx_photography_fts ON photography USING GIN(tsv);<br><br>-- Busca:<br>SELECT * FROM photography<br>WHERE tsv @@ to_tsquery('portuguese', 'retrato & est√∫dio');<br>```<br><br>---<br><br>## üìä Resumo de Estat√≠sticas<br><br>### Contagem de Objetos do Banco<br><br>| Tipo | Quantidade | Detalhes |<br>|------|------------|----------|<br>| **Tabelas** | 5 | photography, design_projects, comments, hero_images, site_content |<br>| **Colunas** | ~60 | Total em todas as tabelas |<br>| **√çndices** | ~20 | Incluindo PKs, FKs e custom |<br>| **Pol√≠ticas RLS** | ~20 | Cobrindo SELECT, INSERT, UPDATE, DELETE |<br>| **Triggers** | 4 | Comments count, updated_at |<br>| **Functions** | 2 | update_comments_count, update_modified_column |<br>| **Constraints** | ~10 | PKs, FKs, CHECKs |<br><br>---<br><br>## üîí Seguran√ßa<br><br>### Checklist de Seguran√ßa Implementada<br><br>- ‚úÖ Row Level Security (RLS) habilitado em todas as tabelas<br>- ‚úÖ Pol√≠ticas de leitura p√∫blica para conte√∫do<br>- ‚úÖ Pol√≠ticas de escrita apenas para autenticados<br>- ‚úÖ Foreign Keys com CASCADE para integridade referencial<br>- ‚úÖ CHECK constraints para valida√ß√£o de dados<br>- ‚úÖ √çndices para prevenir N+1 queries<br>- ‚úÖ Triggers para manter contadores consistentes<br>- ‚úÖ GPS desabilitado na extra√ß√£o EXIF (privacidade)<br><br>---<br><br>## üìö Scripts SQL Utilizados<br><br>### Arquivos de Migra√ß√£o/Setup<br><br>1. **supabase-setup.sql** - Configura√ß√£o inicial<br>2. **cms-setup.sql** - Tabela site_content com 180 registros PT<br>3. **hero-setup.sql** - Tabela hero_images<br>4. **complete_social_setup.sql** - Contadores sociais (likes, shares)<br>5. **comment_approval_migration.sql** - Sistema de modera√ß√£o<br>6. **comment_replies_migration.sql** - Threading/respostas<br>7. **add-events-tags-migration.sql** - Campos event_name, event_date, tags<br>8. **add-exif-columns-migration.sql** - Metadados EXIF<br>9. **fix-delete-permissions.sql** - Corrige pol√≠ticas RLS de DELETE<br>10. **update_comments_count_trigger.sql** - Trigger para contadores<br><br>---<br><br>**Documento criado em**: 30 de Novembro de 2025  <br>**Vers√£o**: 1.0.0<br><br>*Este documento apresenta o schema completo do banco de dados com todos os detalhes t√©cnicos e links para documenta√ß√£o oficial de cada ferramenta.*<br></body></html>
